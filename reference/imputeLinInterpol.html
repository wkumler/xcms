<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Impute values for empty elements in a vector using linear interpolation — imputeLinInterpol • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Impute values for empty elements in a vector using linear interpolation — imputeLinInterpol" />
<meta property="og:description" content="This function provides missing value imputation based on linear
    interpolation and resembles some of the functionality of the
    profBinLin and profBinLinBase functions deprecated from
    version 1.51 on." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.13.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Impute values for empty elements in a vector using linear interpolation</h1>
    <small class="dont-index">Source: <a href='https://github.com/sneumann/xcms/blob/master/R/functions-binning.R'><code>R/functions-binning.R</code></a></small>
    <div class="hidden name"><code>imputeLinInterpol.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function provides missing value imputation based on linear
    interpolation and resembles some of the functionality of the
    <code>profBinLin</code> and <code>profBinLinBase</code> functions deprecated from
    version 1.51 on.</p>
    </div>

    <pre class="usage"><span class='fu'>imputeLinInterpol</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>baseValue</span>,
  method <span class='op'>=</span> <span class='st'>"lin"</span>,
  distance <span class='op'>=</span> <span class='fl'>1L</span>,
  noInterpolAtEnds <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A numeric vector with eventual missing (<code>NA</code>) values.</p></td>
    </tr>
    <tr>
      <th>baseValue</th>
      <td><p>The base value to which empty elements should be set. This
is only considered for <code>method = "linbase"</code> and corresponds to the
<code>profBinLinBase</code>'s <code>baselevel</code> argument.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>One of <code>"none"</code>, <code>"lin"</code> or <code>"linbase"</code>.</p></td>
    </tr>
    <tr>
      <th>distance</th>
      <td><p>For <code>method = "linbase"</code>: number of non-empty
neighboring element of an empty element that should be considered for
linear interpolation. See details section for more information.</p></td>
    </tr>
    <tr>
      <th>noInterpolAtEnds</th>
      <td><p>For <code>method = "lin"</code>: Logical indicating
whether linear interpolation should also be performed at the ends of the
data vector (i.e. if missing values are present at the beginning or the
end of the vector).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A numeric vector with empty values imputed based on the selected
    <code>method</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Values for NAs in input vector <code>x</code> can be imputed using methods
    <code>"lin"</code> and <code>"linbase"</code>:</p>
<p><code>impute = "lin"</code> uses simple linear imputation to derive a value
    for an empty element in input vector <code>x</code> from its neighboring
    non-empty elements. This method is equivalent to the linear
    interpolation in the <code>profBinLin</code> method. Whether interpolation is
    performed if missing values are present at the beginning and end of
    <code>x</code> can be set with argument <code>noInterpolAtEnds</code>. By default
    interpolation is also performed at the ends interpolating from <code>0</code>
    at the beginning and towards <code>0</code> at the end. For
    <code>noInterpolAtEnds = TRUE</code> no interpolation is performed at both
    ends replacing the missing values at the beginning and/or the end of
    <code>x</code> with <code>0</code>.</p>
<p><code>impute = "linbase"</code> uses linear interpolation to impute values for
    empty elements within a user-definable proximity to non-empty elements
    and setting the element's value to the <code>baseValue</code> otherwise. The
    default for the <code>baseValue</code> is half of the smallest value in
    <code>x</code> (<code>NA</code>s being removed). Whether linear interpolation based
    imputation is performed for a missing value depends on the
    <code>distance</code> argument. Interpolation is only performed if one of the
    next <code>distance</code> closest neighbors to the current empty element has
    a value other than <code>NA</code>. No interpolation takes place for
    <code>distance = 0</code>, while <code>distance = 1</code> means that the value for
    an empty element is interpolated from directly adjacent non-empty
    elements while, if the next neighbors of the current empty element are
    also <code>NA</code>, it's vale is set to <code>baseValue</code>.
    This corresponds to the linear interpolation performed by the
    <code>profBinLinBase</code> method. For more details see examples below.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#######</span>
<span class='co'>## Impute missing values by linearly interpolating from neighboring</span>
<span class='co'>## non-empty elements</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='cn'>NA</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='fl'>4</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='fl'>3</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='fl'>2</span><span class='op'>)</span>
<span class='fu'>imputeLinInterpol</span><span class='op'>(</span><span class='va'>x</span>, method <span class='op'>=</span> <span class='st'>"lin"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] 3.000000 2.000000 1.000000 2.000000 2.666667 3.333333 4.000000 3.750000
#&gt;  [9] 3.500000 3.250000 3.000000 2.800000 2.600000 2.400000 2.200000 2.000000</div><div class='input'><span class='co'>## visualize the interpolation:</span>
<span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/plot-methods.html'>plot</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/pSet-class.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/pSet-class.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'>imputeLinInterpol</span><span class='op'>(</span><span class='va'>x</span>, method <span class='op'>=</span> <span class='st'>"lin"</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"l"</span>, col <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>
</div><div class='img'><img src='imputeLinInterpol-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## If the first or last elements are NA, interpolation is performed from 0</span>
<span class='co'>## to the first non-empty element.</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>4</span>, <span class='cn'>NA</span><span class='op'>)</span>
<span class='fu'>imputeLinInterpol</span><span class='op'>(</span><span class='va'>x</span>, method <span class='op'>=</span> <span class='st'>"lin"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1 2 1 4 2</div><div class='input'><span class='co'>## visualize the interpolation:</span>
<span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/plot-methods.html'>plot</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/pSet-class.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/pSet-class.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'>imputeLinInterpol</span><span class='op'>(</span><span class='va'>x</span>, method <span class='op'>=</span> <span class='st'>"lin"</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"l"</span>, col <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>
</div><div class='img'><img src='imputeLinInterpol-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## If noInterpolAtEnds is TRUE no interpolation is performed at both ends</span>
<span class='fu'>imputeLinInterpol</span><span class='op'>(</span><span class='va'>x</span>, method <span class='op'>=</span> <span class='st'>"lin"</span>, noInterpolAtEnds <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0 2 1 4 0</div><div class='input'>
<span class='co'>######</span>
<span class='co'>## method = "linbase"</span>
<span class='co'>## "linbase" performs imputation by interpolation for empty elements based on</span>
<span class='co'>## 'distance' adjacent non-empty elements, setting all remaining empty elements</span>
<span class='co'>## to the baseValue</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='cn'>NA</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='fl'>4</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='fl'>3</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span>, <span class='fl'>2</span><span class='op'>)</span>
<span class='co'>## Setting distance = 0 skips imputation by linear interpolation</span>
<span class='fu'>imputeLinInterpol</span><span class='op'>(</span><span class='va'>x</span>, method <span class='op'>=</span> <span class='st'>"linbase"</span>, distance <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] 3.0 0.5 1.0 2.0 0.5 0.5 4.0 0.5 0.5 0.5 3.0 0.5 0.5 0.5 0.5 2.0</div><div class='input'>
<span class='co'>## With distance = 1 for all empty elements next to a non-empty element the value</span>
<span class='co'>## is imputed by linear interpolation.</span>
<span class='va'>xInt</span> <span class='op'>&lt;-</span> <span class='fu'>imputeLinInterpol</span><span class='op'>(</span><span class='va'>x</span>, method <span class='op'>=</span> <span class='st'>"linbase"</span>, distance <span class='op'>=</span> <span class='fl'>1L</span><span class='op'>)</span>
<span class='va'>xInt</span>
</div><div class='output co'>#&gt;  [1] 3.000000 2.000000 1.000000 2.000000 2.666667 3.333333 4.000000 2.250000
#&gt;  [9] 0.500000 1.750000 3.000000 1.750000 0.500000 0.500000 1.250000 2.000000</div><div class='input'>
<span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/plot-methods.html'>plot</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/pSet-class.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>x</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/pSet-class.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>xInt</span>, type <span class='op'>=</span> <span class='st'>"l"</span>, col <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>
</div><div class='img'><img src='imputeLinInterpol-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Setting distance = 2L would cause that for all empty elements for which the</span>
<span class='co'>## distance to the next non-empty element is &lt;= 2 the value is imputed by</span>
<span class='co'>## linear interpolation:</span>
<span class='va'>xInt</span> <span class='op'>&lt;-</span> <span class='fu'>imputeLinInterpol</span><span class='op'>(</span><span class='va'>x</span>, method <span class='op'>=</span> <span class='st'>"linbase"</span>, distance <span class='op'>=</span> <span class='fl'>2L</span><span class='op'>)</span>
<span class='va'>xInt</span>
</div><div class='output co'>#&gt;  [1] 3.000000 2.000000 1.000000 2.000000 2.666667 3.333333 4.000000 3.750000
#&gt;  [9] 3.500000 3.250000 3.000000 2.800000 2.600000 2.400000 2.200000 2.000000</div><div class='input'>
<span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/plot-methods.html'>plot</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/pSet-class.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>x</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>x</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/pSet-class.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>xInt</span>, type <span class='op'>=</span> <span class='st'>"l"</span>, col <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>
</div><div class='img'><img src='imputeLinInterpol-4.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Steffen Neumann.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9000.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


