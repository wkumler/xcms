<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Chromatographic peak detection using the massifquant method — findChromPeaks-massifquant • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Chromatographic peak detection using the massifquant method — findChromPeaks-massifquant" />
<meta property="og:description" content="Massifquant is a Kalman filter (KF)-based chromatographic peak
    detection for XC-MS data in centroid mode. The identified peaks
    can be further refined with the centWave method (see
    findChromPeaks-centWave for details on centWave)
    by specifying withWave = TRUE.
The MassifquantParam class allows to specify all
    settings for a chromatographic peak detection using the massifquant
    method eventually in combination with the centWave algorithm. Instances
    should be created with the MassifquantParam constructor.
The findChromPeaks,OnDiskMSnExp,MassifquantParam
    method performs chromatographic peak detection using the
    massifquant algorithm on all samples from an
    OnDiskMSnExp object.
    OnDiskMSnExp objects encapsule all experiment
    specific data and load the spectra data (mz and intensity values) on the
    fly from the original files applying also all eventual data
    manipulations.
ppm,ppm&amp;lt;-: getter and setter for the ppm
    slot of the object.
peakwidth,peakwidth&amp;lt;-: getter and setter for the
    peakwidth slot of the object.
snthresh,snthresh&amp;lt;-: getter and setter for the
    snthresh slot of the object.
prefilter,prefilter&amp;lt;-: getter and setter for the
    prefilter slot of the object.
mzCenterFun,mzCenterFun&amp;lt;-: getter and setter for the
    mzCenterFun slot of the object.
integrate,integrate&amp;lt;-: getter and setter for the
    integrate slot of the object.
mzdiff,mzdiff&amp;lt;-: getter and setter for the
    mzdiff slot of the object.
fitgauss,fitgauss&amp;lt;-: getter and setter for the
    fitgauss slot of the object.
noise,noise&amp;lt;-: getter and setter for the
    noise slot of the object.
verboseColumns,verboseColumns&amp;lt;-: getter and
    setter for the verboseColumns slot of the object.
criticalValue,criticalValue&amp;lt;-: getter and
    setter for the criticalValue slot of the object.
consecMissedLimit,consecMissedLimit&amp;lt;-: getter and
    setter for the consecMissedLimit slot of the object.
unions,unions&amp;lt;-: getter and
    setter for the unions slot of the object.
checkBack,checkBack&amp;lt;-: getter and
    setter for the checkBack slot of the object.
withWave,withWave&amp;lt;-: getter and
    setter for the withWave slot of the object." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.13.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Chromatographic peak detection using the massifquant method</h1>
    <small class="dont-index">Source: <a href='https://github.com/sneumann/xcms/blob/master/R/DataClasses.R'><code>R/DataClasses.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/functions-Params.R'><code>R/functions-Params.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/methods-OnDiskMSnExp.R'><code>R/methods-OnDiskMSnExp.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>findChromPeaks-massifquant.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Massifquant is a Kalman filter (KF)-based chromatographic peak
    detection for XC-MS data in centroid mode. The identified peaks
    can be further refined with the <em>centWave</em> method (see
    <code><a href='findChromPeaks-centWave.html'>findChromPeaks-centWave</a></code> for details on centWave)
    by specifying <code>withWave = TRUE</code>.</p>
<p>The <code>MassifquantParam</code> class allows to specify all
    settings for a chromatographic peak detection using the massifquant
    method eventually in combination with the centWave algorithm. Instances
    should be created with the <code>MassifquantParam</code> constructor.</p>
<p>The <code>findChromPeaks,OnDiskMSnExp,MassifquantParam</code>
    method performs chromatographic peak detection using the
    <em>massifquant</em> algorithm on all samples from an
    <code>OnDiskMSnExp</code> object.
    <code>OnDiskMSnExp</code> objects encapsule all experiment
    specific data and load the spectra data (mz and intensity values) on the
    fly from the original files applying also all eventual data
    manipulations.</p>
<p><code>ppm</code>,<code>ppm&lt;-</code>: getter and setter for the <code>ppm</code>
    slot of the object.</p>
<p><code>peakwidth</code>,<code>peakwidth&lt;-</code>: getter and setter for the
    <code>peakwidth</code> slot of the object.</p>
<p><code>snthresh</code>,<code>snthresh&lt;-</code>: getter and setter for the
    <code>snthresh</code> slot of the object.</p>
<p><code>prefilter</code>,<code>prefilter&lt;-</code>: getter and setter for the
    <code>prefilter</code> slot of the object.</p>
<p><code>mzCenterFun</code>,<code>mzCenterFun&lt;-</code>: getter and setter for the
    <code>mzCenterFun</code> slot of the object.</p>
<p><code>integrate</code>,<code>integrate&lt;-</code>: getter and setter for the
    <code>integrate</code> slot of the object.</p>
<p><code>mzdiff</code>,<code>mzdiff&lt;-</code>: getter and setter for the
    <code>mzdiff</code> slot of the object.</p>
<p><code>fitgauss</code>,<code>fitgauss&lt;-</code>: getter and setter for the
    <code>fitgauss</code> slot of the object.</p>
<p><code>noise</code>,<code>noise&lt;-</code>: getter and setter for the
    <code>noise</code> slot of the object.</p>
<p><code>verboseColumns</code>,<code>verboseColumns&lt;-</code>: getter and
    setter for the <code>verboseColumns</code> slot of the object.</p>
<p><code>criticalValue</code>,<code>criticalValue&lt;-</code>: getter and
    setter for the <code>criticalValue</code> slot of the object.</p>
<p><code>consecMissedLimit</code>,<code>consecMissedLimit&lt;-</code>: getter and
    setter for the <code>consecMissedLimit</code> slot of the object.</p>
<p><code>unions</code>,<code>unions&lt;-</code>: getter and
    setter for the <code>unions</code> slot of the object.</p>
<p><code>checkBack</code>,<code>checkBack&lt;-</code>: getter and
    setter for the <code>checkBack</code> slot of the object.</p>
<p><code>withWave</code>,<code>withWave&lt;-</code>: getter and
    setter for the <code>withWave</code> slot of the object.</p>
    </div>

    <pre class="usage"><span class='fu'>MassifquantParam</span><span class='op'>(</span>
  ppm <span class='op'>=</span> <span class='fl'>25</span>,
  peakwidth <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>50</span><span class='op'>)</span>,
  snthresh <span class='op'>=</span> <span class='fl'>10</span>,
  prefilter <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>100</span><span class='op'>)</span>,
  mzCenterFun <span class='op'>=</span> <span class='st'>"wMean"</span>,
  integrate <span class='op'>=</span> <span class='fl'>1L</span>,
  mzdiff <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.001</span>,
  fitgauss <span class='op'>=</span> <span class='cn'>FALSE</span>,
  noise <span class='op'>=</span> <span class='fl'>0</span>,
  verboseColumns <span class='op'>=</span> <span class='cn'>FALSE</span>,
  criticalValue <span class='op'>=</span> <span class='fl'>1.125</span>,
  consecMissedLimit <span class='op'>=</span> <span class='fl'>2</span>,
  unions <span class='op'>=</span> <span class='fl'>1</span>,
  checkBack <span class='op'>=</span> <span class='fl'>0</span>,
  withWave <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='co'># S4 method for OnDiskMSnExp,MassifquantParam</span>
<span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>param</span>,
  BPPARAM <span class='op'>=</span> <span class='fu'>bpparam</span><span class='op'>(</span><span class='op'>)</span>,
  return.type <span class='op'>=</span> <span class='st'>"XCMSnExp"</span>,
  msLevel <span class='op'>=</span> <span class='fl'>1L</span>
<span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>ppm</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>ppm</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>peakwidth</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>peakwidth</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>snthresh</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>snthresh</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>prefilter</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>prefilter</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>mzCenterFun</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>mzCenterFun</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='https://rdrr.io/r/stats/integrate.html'>integrate</a></span><span class='op'>(</span><span class='va'>f</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='https://rdrr.io/r/stats/integrate.html'>integrate</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>mzdiff</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>mzdiff</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>fitgauss</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>fitgauss</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>noise</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>noise</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>verboseColumns</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>verboseColumns</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'>criticalValue</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'>criticalValue</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'>consecMissedLimit</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'>consecMissedLimit</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'>unions</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'>unions</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'>checkBack</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'>checkBack</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'>withWave</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MassifquantParam</span>
<span class='fu'>withWave</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ppm</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the maximal tolerated m/z deviation in
consecutive scans in parts per million (ppm) for the initial ROI
definition.</p></td>
    </tr>
    <tr>
      <th>peakwidth</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code>. Only the first element is used by
massifquant, which specifices the minimum peak length in time scans.
For <code>withWave = TRUE</code> the second argument represents the maximum
peak length subject to being greater than the mininum peak length
(see also documentation of <code><a href='do_findChromPeaks_centWave.html'>do_findChromPeaks_centWave</a></code>).</p></td>
    </tr>
    <tr>
      <th>snthresh</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the signal to noise ratio cutoff.</p></td>
    </tr>
    <tr>
      <th>prefilter</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code>. The first argument is only used
if (<code>withWave = TRUE</code>); see <code><a href='findChromPeaks-centWave.html'>findChromPeaks-centWave</a></code>
for details. The second argument specifies the minimum threshold for the
maximum intensity of a chromatographic peak that must be met.</p></td>
    </tr>
    <tr>
      <th>mzCenterFun</th>
      <td><p>Name of the function to calculate the m/z center of the
chromatographic peak. Allowed are: <code>"wMean"</code>: intensity weighted
mean of the peak's m/z values, <code>"mean"</code>: mean of the peak's m/z
values, <code>"apex"</code>: use the m/z value at the peak apex,
<code>"wMeanApex3"</code>: intensity weighted mean of the m/z value at the
peak apex and the m/z values left and right of it and <code>"meanApex3"</code>:
mean of the m/z value of the peak apex and the m/z values left and right
of it.</p></td>
    </tr>
    <tr>
      <th>integrate</th>
      <td><p>Integration method. For <code>integrate = 1</code> peak limits
are found through descent on the mexican hat filtered data, for
<code>integrate = 2</code> the descent is done on the real data. The latter
method is more accurate but prone to noise, while the former is more
robust, but less exact.</p></td>
    </tr>
    <tr>
      <th>mzdiff</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> representing the minimum difference in m/z
dimension required for peaks with overlapping retention times; can be
negative to allow overlap. During peak post-processing, peaks
defined to be overlapping are reduced to the one peak with the largest
signal.</p></td>
    </tr>
    <tr>
      <th>fitgauss</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether or not a Gaussian should be fitted
to each peak. This affects mostly the retention time position of the
peak.</p></td>
    </tr>
    <tr>
      <th>noise</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> allowing to set a minimum intensity required
for centroids to be considered in the first analysis step (centroids with
intensity <code>&lt; noise</code> are omitted from ROI detection).</p></td>
    </tr>
    <tr>
      <th>verboseColumns</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether additional peak meta data
columns should be returned.</p></td>
    </tr>
    <tr>
      <th>criticalValue</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code>. Suggested values:
(<code>0.1-3.0</code>). This setting helps determine the the Kalman Filter
prediciton margin of error. A real centroid belonging to a bonafide
peak must fall within the KF prediction margin of error. Much like
in the construction of a confidence interval, <code>criticalVal</code> loosely
translates to be a multiplier of the standard error of the prediction
reported by the Kalman Filter. If the peak in the XC-MS sample have
a small mass deviance in ppm error, a smaller critical value might be
better and vice versa.</p></td>
    </tr>
    <tr>
      <th>consecMissedLimit</th>
      <td><p><code><a href='https://rdrr.io/r/base/integer.html'>integer(1)</a></code> Suggested values: (<code>1,2,3</code>).
While a peak is in the proces of being detected by a Kalman Filter, the
Kalman Filter may not find a predicted centroid in every scan. After 1
or more consecutive failed predictions, this setting informs Massifquant
when to stop a Kalman Filter from following a candidate peak.</p></td>
    </tr>
    <tr>
      <th>unions</th>
      <td><p><code><a href='https://rdrr.io/r/base/integer.html'>integer(1)</a></code> set to <code>1</code> if apply t-test union on
segmentation; set to <code>0</code> if no t-test to be applied on
chromatographically continous peaks sharing same m/z range.
Explanation: With very few data points, sometimes a Kalman Filter stops
tracking a peak prematurely. Another Kalman Filter is instantiated
and begins following the rest of the signal. Because tracking is done
backwards to forwards, this algorithmic defect leaves a real peak
divided into two segments or more. With this option turned on, the
program identifies segmented peaks and combines them (merges them)
into one with a two sample t-test. The potential danger of this option
is that some truly distinct peaks may be merged.</p></td>
    </tr>
    <tr>
      <th>checkBack</th>
      <td><p><code><a href='https://rdrr.io/r/base/integer.html'>integer(1)</a></code> set to <code>1</code> if turned on; set to
<code>0</code> if turned off. The convergence of a Kalman Filter to a peak's
precise m/z mapping is very fast, but sometimes it incorporates erroneous
centroids as part of a peak (especially early on). The <code>scanBack</code>
option is an attempt to remove the occasional outlier that lies beyond
the converged bounds of the Kalman Filter. The option does not directly
affect identification of a peak because it is a postprocessing measure;
it has not shown to be a extremely useful thus far and the default is set
to being turned off.</p></td>
    </tr>
    <tr>
      <th>withWave</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> if <code>TRUE</code>, the peaks identified first
with Massifquant are subsequently filtered with the second step of the
centWave algorithm, which includes wavelet estimation.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>For <code>findChromPeaks</code>: an
    <code>OnDiskMSnExp</code> object containing the MS- and all
    other experiment-relevant data.</p>
<p>For all other methods: a parameter object.</p></td>
    </tr>
    <tr>
      <th>param</th>
      <td><p>An <code>MassifquantParam</code> object containing all settings for
the massifquant algorithm.</p></td>
    </tr>
    <tr>
      <th>BPPARAM</th>
      <td><p>A parameter class specifying if and how parallel processing
should be performed. It defaults to <code>bpparam</code>.
See documentation of the <code>BiocParallel</code> for more details. If
parallel processing is enabled, peak detection is performed in parallel
on several of the input samples.</p></td>
    </tr>
    <tr>
      <th>return.type</th>
      <td><p>Character specifying what type of object the method should
return. Can be either <code>"XCMSnExp"</code> (default), <code>"list"</code> or
<code>"xcmsSet"</code>.</p></td>
    </tr>
    <tr>
      <th>msLevel</th>
      <td><p><code><a href='https://rdrr.io/r/base/integer.html'>integer(1)</a></code> defining the MS level on which the peak
detection should be performed. Defaults to <code>msLevel = 1</code>.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>The value for the slot.</p></td>
    </tr>
    <tr>
      <th>f</th>
      <td><p>For <code>integrate</code>: a <code>MassifquantParam</code> object.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The <code>MassifquantParam</code> function returns a
    <code>MassifquantParam</code> class instance with all of the settings
    specified for chromatographic peak detection by the <em>massifquant</em>
    method.</p>
<p>For <code>findChromPeaks</code>: if <code>return.type = "XCMSnExp"</code> an
    <code><a href='XCMSnExp-class.html'>XCMSnExp</a></code> object with the results of the peak detection.
    If <code>return.type = "list"</code> a list of length equal to the number of
    samples with matrices specifying the identified peaks.
    If <code>return.type = "xcmsSet"</code> an <code><a href='xcmsSet-class.html'>xcmsSet</a></code> object
    with the results of the peak detection.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This algorithm's performance has been tested rigorously
    on high resolution LC/OrbiTrap, TOF-MS data in centroid mode.
    Simultaneous kalman filters identify chromatographic peaks and calculate
    their area under the curve. The default parameters are set to operate on
    a complex LC-MS Orbitrap sample. Users will find it useful to do some
    simple exploratory data analysis to find out where to set a minimum
    intensity, and identify how many scans an average peak spans. The
    <code>consecMissedLimit</code> parameter has yielded good performance on
    Orbitrap data when set to (<code>2</code>) and on TOF data it was found best
    to be at (<code>1</code>). This may change as the algorithm has yet to be
    tested on many samples. The <code>criticalValue</code> parameter is perhaps
    most dificult to dial in appropriately and visual inspection of peak
    identification is the best suggested tool for quick optimization.
    The <code>ppm</code> and <code>checkBack</code> parameters have shown less influence
    than the other parameters and exist to give users flexibility and
    better accuracy.</p>
<p>Parallel processing (one process per sample) is supported and can
    be configured either by the <code>BPPARAM</code> parameter or by globally
    defining the parallel processing mode using the
    <code>register</code> method from the <code>BiocParallel</code>
    package.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl>
<dt><code>ppm,peakwidth,snthresh,prefilter,mzCenterFun,integrate,mzdiff,fitgauss,noise,verboseColumns,criticalValue,consecMissedLimit,unions,checkBack,withWave</code></dt><dd><p>See corresponding parameter above. Slots values should
exclusively be accessed <em>via</em> the corresponding getter and setter
methods listed above.</p></dd>

</dl>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>These methods and classes are part of the updated and modernized
    <code>xcms</code> user interface which will eventually replace the
    <code><a href='findPeaks-methods.html'>findPeaks</a></code> methods. It supports chromatographic peak
    detection on
    <code><a href='https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html'>OnDiskMSnExp</a></code> objects (defined in the
    <code>MSnbase</code> package). All of the settings to the massifquant and
    centWave algorithm can be passed with a <code>MassifquantParam</code> object.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Conley CJ, Smith R, Torgrip RJ, Taylor RM, Tautenhahn R and Prince JT
"Massifquant: open-source Kalman filter-based XC-MS isotope trace feature
detection" <em>Bioinformatics</em> 2014, 30(18):2636-43.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The <code><a href='do_findChromPeaks_massifquant.html'>do_findChromPeaks_massifquant</a></code> core API function
    and <code><a href='findPeaks.massifquant-methods.html'>findPeaks.massifquant</a></code> for the old user interface.</p>
<p><code><a href='XCMSnExp-class.html'>XCMSnExp</a></code> for the object containing the results of
    the peak detection.</p>
<p>Other peak detection methods: 
<code><a href='chromatographic-peak-detection.html'>chromatographic-peak-detection</a></code>,
<code><a href='findChromPeaks-centWaveWithPredIsoROIs.html'>findChromPeaks-centWaveWithPredIsoROIs</a></code>,
<code><a href='findChromPeaks-centWave.html'>findChromPeaks-centWave</a></code>,
<code><a href='findChromPeaks-matchedFilter.html'>findChromPeaks-matchedFilter</a></code>,
<code><a href='findPeaks-MSW.html'>findPeaks-MSW</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Christopher Conley, Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Create a MassifquantParam object.</span>
<span class='va'>mqp</span> <span class='op'>&lt;-</span> <span class='fu'>MassifquantParam</span><span class='op'>(</span><span class='op'>)</span>
<span class='co'>## Change snthresh prefilter parameters</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>snthresh</a></span><span class='op'>(</span><span class='va'>mqp</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fl'>30</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>prefilter</a></span><span class='op'>(</span><span class='va'>mqp</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>, <span class='fl'>10000</span><span class='op'>)</span>
<span class='va'>mqp</span>
</div><div class='output co'>#&gt; Object of class:  MassifquantParam 
#&gt;  Parameters:
#&gt;  - ppm: [1] 25
#&gt;  - peakwidth: [1] 20 50
#&gt;  - snthresh: [1] 30
#&gt;  - prefilter: [1]     6 10000
#&gt;  - mzCenterFun: [1] "wMean"
#&gt;  - integrate: [1] 1
#&gt;  - mzdiff: [1] -0.001
#&gt;  - fitgauss: [1] FALSE
#&gt;  - noise: [1] 0
#&gt;  - verboseColumns: [1] FALSE
#&gt;  - criticalValue: [1] 1.125
#&gt;  - consecMissedLimit: [1] 2
#&gt;  - unions: [1] 1
#&gt;  - checkBack: [1] 0
#&gt;  - withWave: [1] FALSE</div><div class='input'>
<span class='co'>## Perform the peak detection using massifquant on the files from the</span>
<span class='co'>## faahKO package. Files are read using the readMSData from the MSnbase</span>
<span class='co'>## package</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://dx.doi.org/10.1021/bi0480335'>faahKO</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://lgatto.github.io/MSnbase'>MSnbase</a></span><span class='op'>)</span>
<span class='va'>fls</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>dir</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"cdf/KO"</span>, package <span class='op'>=</span> <span class='st'>"faahKO"</span><span class='op'>)</span>, recursive <span class='op'>=</span> <span class='cn'>TRUE</span>,
           full.names <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>raw_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/readMSData.html'>readMSData</a></span><span class='op'>(</span><span class='va'>fls</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, mode <span class='op'>=</span> <span class='st'>"onDisk"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span></div><div class='input'><span class='co'>## Perform the peak detection using the settings defined above.</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span><span class='op'>(</span><span class='va'>raw_data</span>, param <span class='op'>=</span> <span class='va'>mqp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'> Massifquant, Copyright (C) 2013 Brigham Young University.</span></div><div class='output co'>#&gt; <span class='message'> Massifquant comes with ABSOLUTELY NO WARRANTY. See LICENSE for details.</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'> Detecting  mass traces at 25ppm ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'> 334 Peaks.</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='XCMSnExp-class.html'>chromPeaks</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          mz mzmin mzmax    rtmin    rtmax       rt    into   maxo sample
#&gt; CP001 578.4 578.4 578.4 4103.890 4141.449 4119.540 1748295 187328      1
#&gt; CP002 577.3 577.3 577.3 4100.760 4130.495 4114.845 3854210 457024      1
#&gt; CP003 367.2 367.2 367.2 4099.196 4164.924 4122.670  140753  11330      1
#&gt; CP004 459.1 459.1 459.1 4099.196 4128.930 4113.280  144739  15874      1
#&gt; CP005 401.2 401.2 401.2 4083.546 4221.262 4147.709  472407  11783      1
#&gt; CP006 412.3 412.3 412.3 4072.591 4111.715 4089.806 2192350 183936      1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Steffen Neumann.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9000.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


