<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Align retention times across samples using Obiwarp — adjustRtime-obiwarp • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Align retention times across samples using Obiwarp — adjustRtime-obiwarp" />
<meta property="og:description" content="This method performs retention time adjustment using the
Obiwarp method [Prince 2006]. It is based on the code at
http://obi-warp.sourceforge.net but supports alignment of multiple
samples by aligning each against a center sample. The alignment is
performed directly on the profile-matrix and can hence be
performed independently of the peak detection or peak grouping.
It is also possible to exclude certain samples within an experiment from
the estimation of the alignment models. The parameter subset
allows to define the indices of samples within object that should
be aligned. Samples not part of this subset are left out in the
estimation of the alignment models, but their retention times are
subsequently adjusted based on the alignment results of the closest sample
in subset (close in terms of position within the object).
Alignment could thus be performed on only real samples leaving out
e.g. blanks, which are then in turn adjusted based on the closest real
sample. Here it is up to the user to ensure that the samples within
object are ordered correctly (e.g. by injection index).
How the non-subset samples are adjusted bases also on the parameter
subsetAdjust: with subsetAdjust = &quot;previous&quot;, each non-subset
sample is adjusted based on the closest previous subset sample which results
in most cases with adjusted retention times of the non-subset sample being
identical to the subset sample on which the adjustment bases. The second,
default, option is to use subsetAdjust = &quot;average&quot; in which case
each non subset sample is adjusted based on the average retention time
adjustment from the previous and following subset sample. For the average
a weighted mean is used with weights being the inverse of the distance of
the non-subset sample to the subset samples used for alignment.
See also section Alignment of experiments including blanks in the
xcms vignette for an example.
The ObiwarpParam class allows to specify all
    settings for the retention time adjustment based on the obiwarp
    method. Class Instances should be created using the
    ObiwarpParam constructor.
binSize,binSize&amp;lt;-: getter and setter
    for the binSize slot of the object.
centerSample,centerSample&amp;lt;-: getter and setter
    for the centerSample slot of the object.
response,response&amp;lt;-: getter and setter
    for the response slot of the object.
distFun,distFun&amp;lt;-: getter and setter
    for the distFun slot of the object.
gapInit,gapInit&amp;lt;-: getter and setter
    for the gapInit slot of the object.
gapExtend,gapExtend&amp;lt;-: getter and setter
    for the gapExtend slot of the object.
factorDiag,factorDiag&amp;lt;-: getter and setter
     for the factorDiag slot of the object.
factorGap,factorGap&amp;lt;-: getter and setter
    for the factorGap slot of the object.
localAlignment,localAlignment&amp;lt;-: getter and setter
    for the localAlignment slot of the object.
initPenalty,initPenalty&amp;lt;-: getter and setter
    for the initPenalty slot of the object.
subset,subset&amp;lt;-: getter and
    setter for the subset slot of the object.
subsetAdjust,subsetAdjust&amp;lt;-: getter and
    setter for the subsetAdjust slot of the object.
adjustRtime,XCMSnExp,ObiwarpParam:
performs retention time correction/alignment based on the total mz-rt
data using the obiwarp method." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/new_functionality.html">New and modified functionality in xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Align retention times across samples using Obiwarp</h1>
    <small class="dont-index">Source: <a href='https://github.com/sneumann/xcms/blob/master/R/DataClasses.R'><code>R/DataClasses.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/functions-Params.R'><code>R/functions-Params.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/methods-OnDiskMSnExp.R'><code>R/methods-OnDiskMSnExp.R</code></a>, and 2 more</small>
    <div class="hidden name"><code>adjustRtime-obiwarp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This method performs retention time adjustment using the
Obiwarp method [Prince 2006]. It is based on the code at
<a href='http://obi-warp.sourceforge.net'>http://obi-warp.sourceforge.net</a> but supports alignment of multiple
samples by aligning each against a <em>center</em> sample. The alignment is
performed directly on the <code><a href='profMat-xcmsSet.html'>profile-matrix</a></code> and can hence be
performed independently of the peak detection or peak grouping.</p>
<p>It is also possible to exclude certain samples within an experiment from
the estimation of the alignment models. The parameter <code>subset</code>
allows to define the indices of samples within <code>object</code> that should
be aligned. Samples not part of this <code>subset</code> are left out in the
estimation of the alignment models, but their retention times are
subsequently adjusted based on the alignment results of the closest sample
in <code>subset</code> (close in terms of position within the <code>object</code>).
Alignment could thus be performed on only <em>real</em> samples leaving out
e.g. blanks, which are then in turn adjusted based on the closest real
sample. Here it is up to the user to ensure that the samples within
<code>object</code> are ordered correctly (e.g. by injection index).</p>
<p>How the non-subset samples are adjusted bases also on the parameter
<code>subsetAdjust</code>: with <code>subsetAdjust = "previous"</code>, each non-subset
sample is adjusted based on the closest previous subset sample which results
in most cases with adjusted retention times of the non-subset sample being
identical to the subset sample on which the adjustment bases. The second,
default, option is to use <code>subsetAdjust = "average"</code> in which case
each non subset sample is adjusted based on the average retention time
adjustment from the previous and following subset sample. For the average
a weighted mean is used with weights being the inverse of the distance of
the non-subset sample to the subset samples used for alignment.</p>
<p>See also section <em>Alignment of experiments including blanks</em> in the
<em>xcms</em> vignette for an example.</p>
<p>The <code>ObiwarpParam</code> class allows to specify all
    settings for the retention time adjustment based on the <em>obiwarp</em>
    method. Class Instances should be created using the
    <code>ObiwarpParam</code> constructor.</p>
<p><code>binSize</code>,<code>binSize&lt;-</code>: getter and setter
    for the <code>binSize</code> slot of the object.</p>
<p><code>centerSample</code>,<code>centerSample&lt;-</code>: getter and setter
    for the <code>centerSample</code> slot of the object.</p>
<p><code>response</code>,<code>response&lt;-</code>: getter and setter
    for the <code>response</code> slot of the object.</p>
<p><code>distFun</code>,<code>distFun&lt;-</code>: getter and setter
    for the <code>distFun</code> slot of the object.</p>
<p><code>gapInit</code>,<code>gapInit&lt;-</code>: getter and setter
    for the <code>gapInit</code> slot of the object.</p>
<p><code>gapExtend</code>,<code>gapExtend&lt;-</code>: getter and setter
    for the <code>gapExtend</code> slot of the object.</p>
<p><code>factorDiag</code>,<code>factorDiag&lt;-</code>: getter and setter
     for the <code>factorDiag</code> slot of the object.</p>
<p><code>factorGap</code>,<code>factorGap&lt;-</code>: getter and setter
    for the <code>factorGap</code> slot of the object.</p>
<p><code>localAlignment</code>,<code>localAlignment&lt;-</code>: getter and setter
    for the <code>localAlignment</code> slot of the object.</p>
<p><code>initPenalty</code>,<code>initPenalty&lt;-</code>: getter and setter
    for the <code>initPenalty</code> slot of the object.</p>
<p><code>subset</code>,<code>subset&lt;-</code>: getter and
    setter for the <code>subset</code> slot of the object.</p>
<p><code>subsetAdjust</code>,<code>subsetAdjust&lt;-</code>: getter and
    setter for the <code>subsetAdjust</code> slot of the object.</p>
<p><code>adjustRtime,XCMSnExp,ObiwarpParam</code>:
performs retention time correction/alignment based on the total mz-rt
data using the <em>obiwarp</em> method.</p>
    </div>

    <pre class="usage"><span class='fu'>ObiwarpParam</span>(
  <span class='kw'>binSize</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>centerSample</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>integer</a></span>(),
  <span class='kw'>response</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='kw'>distFun</span> <span class='kw'>=</span> <span class='st'>"cor_opt"</span>,
  <span class='kw'>gapInit</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  <span class='kw'>gapExtend</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  <span class='kw'>factorDiag</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>factorGap</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>localAlignment</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>initPenalty</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>subset</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>integer</a></span>(),
  <span class='kw'>subsetAdjust</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"average"</span>, <span class='st'>"previous"</span>)
)

<span class='co'># S4 method for OnDiskMSnExp,ObiwarpParam</span>
<span class='fu'><a href='adjustRtime.html'>adjustRtime</a></span>(<span class='no'>object</span>, <span class='no'>param</span>, <span class='kw'>msLevel</span> <span class='kw'>=</span> <span class='fl'>1L</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>show</span>(<span class='no'>object</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'><a href='findChromPeaks-matchedFilter.html'>binSize</a></span>(<span class='no'>object</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'><a href='findChromPeaks-matchedFilter.html'>binSize</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>centerSample</span>(<span class='no'>object</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>centerSample</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>response</span>(<span class='no'>object</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>response</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>distFun</span>(<span class='no'>object</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>distFun</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>gapInit</span>(<span class='no'>object</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>gapInit</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>gapExtend</span>(<span class='no'>object</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>gapExtend</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>factorDiag</span>(<span class='no'>object</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>factorDiag</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>factorGap</span>(<span class='no'>object</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>factorGap</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>localAlignment</span>(<span class='no'>object</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>localAlignment</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>initPenalty</span>(<span class='no'>object</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'>initPenalty</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'><a href='adjustRtime-peakGroups.html'>subset</a></span>(<span class='no'>x</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'><a href='adjustRtime-peakGroups.html'>subset</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'><a href='adjustRtime-peakGroups.html'>subsetAdjust</a></span>(<span class='no'>object</span>)

<span class='co'># S4 method for ObiwarpParam</span>
<span class='fu'><a href='adjustRtime-peakGroups.html'>subsetAdjust</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for XCMSnExp,ObiwarpParam</span>
<span class='fu'><a href='adjustRtime.html'>adjustRtime</a></span>(<span class='no'>object</span>, <span class='no'>param</span>, <span class='kw'>msLevel</span> <span class='kw'>=</span> <span class='fl'>1L</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>binSize</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the bin size (in mz dimension)
to be used for the <em>profile matrix</em> generation. See <code>step</code>
parameter in <code><a href='profMat-xcmsSet.html'>profile-matrix</a></code> documentation for more details.</p></td>
    </tr>
    <tr>
      <th>centerSample</th>
      <td><p><code><a href='https://rdrr.io/r/base/integer.html'>integer(1)</a></code> defining the index of the center sample
in the experiment. It defaults to
<code><a href='https://rdrr.io/r/base/Round.html'>floor(median(1:length(fileNames(object))))</a></code>. Note that if
<code>subset</code> is used, the index passed with <code>centerSample</code> is
within these subset samples.</p></td>
    </tr>
    <tr>
      <th>response</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the <em>responsiveness</em> of
warping with <code>response = 0</code> giving linear warping on start and end
points and <code>response = 100</code> warping using all bijective anchors.</p></td>
    </tr>
    <tr>
      <th>distFun</th>
      <td><p>character defining the distance function to be used. Allowed
values are <code>"cor"</code> (Pearson's correlation), <code>"cor_opt"</code>
(calculate only 10% diagonal band of distance matrix; better runtime),
<code>"cov"</code> (covariance), <code>"prd"</code> (product) and <code>"euc"</code>
(Euclidian distance). The default value is <code>distFun = "cor_opt"</code>.</p></td>
    </tr>
    <tr>
      <th>gapInit</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the penalty for gap opening. The
default value for <code>gapInit</code> depends on the value of <code>distFun</code>:
for <code>distFun = "cor"</code> and <code>distFun = "cor_opt"</code> it is
<code>0.3</code>, for <code>distFun = "cov"</code> and <code>distFun = "prd"</code>
<code>0.0</code> and for <code>distFun = "euc"</code> <code>0.9</code>.</p></td>
    </tr>
    <tr>
      <th>gapExtend</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the penalty for gap enlargement.
The default value for <code>gapExtend</code> depends on the value of
<code>distFun</code>, for <code>distFun = "cor"</code> and
<code>distFun = "cor_opt"</code> it is <code>2.4</code>, for <code>distFun = "cov"</code>
<code>11.7</code>, for <code>distFun = "euc"</code> <code>1.8</code> and for
<code>distFun = "prd"</code> 7.8.</p></td>
    </tr>
    <tr>
      <th>factorDiag</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the local weight applied to
diagonal moves in the alignment.</p></td>
    </tr>
    <tr>
      <th>factorGap</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the local weight for gap moves
in the alignment.</p></td>
    </tr>
    <tr>
      <th>localAlignment</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether a local alignment should be
performed instead of the default global alignment.</p></td>
    </tr>
    <tr>
      <th>initPenalty</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the penalty for initiating an
alignment (for local alignment only).</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p><code>integer</code> with the indices of samples within the
experiment on which the alignment models should be estimated. Samples
not part of the subset are adjusted based on the closest subset sample.
See description above for more details.</p></td>
    </tr>
    <tr>
      <th>subsetAdjust</th>
      <td><p><code>character</code> specifying the method with which
non-subset samples should be adjusted. Supported options are
<code>"previous"</code> and <code>"average"</code> (default). See description above
for more information.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>For <code>adjustRtime</code>: an <code><a href='XCMSnExp-class.html'>XCMSnExp</a></code> object.</p>
<p>For all other methods: a <code>ObiwarpParam</code> object.</p></td>
    </tr>
    <tr>
      <th>param</th>
      <td><p>A <code>ObiwarpParam</code> object containing all settings for
the alignment method.</p></td>
    </tr>
    <tr>
      <th>msLevel</th>
      <td><p><code>integer</code> defining the MS level on which the retention
time should be performed.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>The value for the slot.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>a <code>PeakGroupsParam</code> object.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The <code>ObiwarpParam</code> function returns a
    <code>ObiwarpParam</code> class instance with all of the settings
    specified for obiwarp retention time adjustment and alignment.</p>
<p>For <code>adjustRtime,XCMSnExp,ObiwarpParam</code>: a
<code><a href='XCMSnExp-class.html'>XCMSnExp</a></code> object with the results of the retention time
adjustment step. These can be accessed with the
<code><a href='XCMSnExp-class.html'>adjustedRtime</a></code> method. Retention time correction does also
adjust the retention time of the identified chromatographic peaks
(accessed <em>via</em> <code><a href='XCMSnExp-class.html'>chromPeaks</a></code>. Note that retention time
correction drops all previous peak grouping results from the result
object.</p>
<p>For <code>adjustRtime,OnDiskMSnExp,ObiwarpParam</code>: a <code>numeric</code> with
the adjusted retention times per spectra (in the same order than
<code>rtime</code>).</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl>
<dt><code>.__classVersion__,binSize,centerSample,response,distFun,gapInit,gapExtend,factorDiag,factorGap,localAlignment,initPenalty,subset,subsetAdjust</code></dt><dd><p>See corresponding parameter above. <code>.__classVersion__</code> stores
the version from the class. Slots values should exclusively be accessed
<em>via</em> the corresponding getter and setter methods listed above.</p></dd>

</dl>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>These methods and classes are part of the updated and modernized
<code>xcms</code> user interface which will eventually replace the
<code><a href='retcor-methods.html'>retcor</a></code> methods. All of the settings to the alignment
algorithm can be passed with a <code>ObiwarpParam</code> object.</p>
<p>Alignment using obiwarp is performed on the retention time of spectra
of on MS level. Retention times for spectra of other MS levels are
subsequently adjusted based on the adjustment function defined on the
retention times of the spectra of MS level <code>msLevel</code>.</p>
<p>Calling <code>adjustRtime</code> on an <code>XCMSnExp</code> object will cause
all peak grouping (correspondence) results and any previous retention
time adjustment results to be dropped.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>John T. Prince and Edward M. Marcotte. "Chromatographic Alignment of
ESI-LC-MS Proteomics Data Sets by Ordered Bijective Interpolated Warping"
<em>Anal. Chem.</em> 2006, 78(17):6140-6152.</p>
<p>John T. Prince and Edward M. Marcotte. "Chromatographic Alignment of
ESI-LC-MS Proteomic Data Sets by Ordered Bijective Interpolated Warping"
<em>Anal. Chem.</em> 2006, 78 (17), 6140-6152.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='retcor.obiwarp-methods.html'>retcor.obiwarp</a></code> for the old user interface.
    <code><a href='plotAdjustedRtime.html'>plotAdjustedRtime</a></code> for visualization of alignment results.</p>
<p><code><a href='XCMSnExp-class.html'>XCMSnExp</a></code> for the object containing the results of
    the alignment.</p>
<p>Other retention time correction methods: 
<code><a href='adjustRtime-peakGroups.html'>adjustRtime-peakGroups</a></code>,
<code><a href='adjustRtime.html'>adjustRtime</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>faahKO</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>MSnbase</span>)
<span class='no'>fls</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>dir</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"cdf/KO"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"faahKO"</span>), <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
           <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>## Reading 2 of the KO samples</span>
<span class='no'>raw_data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MSnbase/man/readMSData.html'>readMSData</a></span>(<span class='no'>fls</span>[<span class='fl'>1</span>:<span class='fl'>2</span>], <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"onDisk"</span>)</div><div class='output co'>#&gt; <span class='message'>Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span></div><div class='input'>
<span class='co'>## Perform retention time correction on the OnDiskMSnExp:</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='adjustRtime.html'>adjustRtime</a></span>(<span class='no'>raw_data</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'>ObiwarpParam</span>())</div><div class='output co'>#&gt; <span class='message'>Sample number 1 used as center sample.</span></div><div class='output co'>#&gt; <span class='message'>Aligning ko16.CDF against ko15.CDF ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='co'>## As a result we get a numeric vector with the adjusted retention times for</span>
<span class='co'>## all spectra.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>res</span>)</div><div class='output co'>#&gt; F1.S0001 F1.S0002 F1.S0003 F1.S0004 F1.S0005 F1.S0006 
#&gt; 2501.378 2502.943 2504.508 2506.073 2507.638 2509.203 </div><div class='input'>
<span class='co'>## We can split this by file to get the adjusted retention times for each</span>
<span class='co'>## file</span>
<span class='no'>resL</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span>(<span class='no'>res</span>, <span class='fu'><a href='https://rdrr.io/pkg/MSnbase/man/Spectrum-class.html'>fromFile</a></span>(<span class='no'>raw_data</span>))

<span class='co'>##############################</span>
<span class='co'>## Perform retention time correction on an XCMSnExp:</span>
<span class='co'>##</span>
<span class='co'>## Perform first the chromatographic peak detection using the matchedFilter</span>
<span class='co'>## method.</span>
<span class='no'>mfp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='findChromPeaks-matchedFilter.html'>MatchedFilterParam</a></span>(<span class='kw'>snthresh</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>binSize</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span>(<span class='no'>raw_data</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='no'>mfp</span>)

<span class='co'>## Performing the retention time adjustment using obiwarp.</span>
<span class='no'>res_2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='adjustRtime.html'>adjustRtime</a></span>(<span class='no'>res</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'>ObiwarpParam</span>())</div><div class='output co'>#&gt; <span class='message'>Sample number 1 used as center sample.</span></div><div class='output co'>#&gt; <span class='message'>Aligning ko16.CDF against ko15.CDF ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Applying retention time adjustment to the identified chromatographic peaks ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/MSnbase/man/Spectrum-class.html'>rtime</a></span>(<span class='no'>res_2</span>))</div><div class='output co'>#&gt; F1.S0001 F1.S0002 F1.S0003 F1.S0004 F1.S0005 F1.S0006 
#&gt; 2501.378 2502.943 2504.508 2506.073 2507.638 2509.203 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/MSnbase/man/Spectrum-class.html'>rtime</a></span>(<span class='no'>raw_data</span>))</div><div class='output co'>#&gt; F1.S0001 F1.S0002 F1.S0003 F1.S0004 F1.S0005 F1.S0006 
#&gt; 2501.378 2502.943 2504.508 2506.073 2507.638 2509.203 </div><div class='input'>
<span class='co'>## Also the retention times of the detected peaks were adjusted.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span>(<span class='fu'><a href='XCMSnExp-class.html'>chromPeaks</a></span>(<span class='no'>res</span>))</div><div class='output co'>#&gt;             mz mzmin mzmax       rt    rtmin    rtmax      into     intf   maxo
#&gt; CP545 593.3951 592.2 593.4 3704.827 3692.307 3715.782  881555.1  2243033 118256
#&gt; CP546 593.4661 593.4 593.5 3712.652 3698.567 3726.736 2446358.7  5385574 124240
#&gt; CP547 593.5000 593.5 593.5 3715.782 3703.262 3729.866 1702931.4  4186604 124240
#&gt; CP548 596.3343 596.3 596.4 3815.939 3801.854 3830.023 4482351.4 10099603 236352
#&gt; CP549 596.3343 596.3 596.4 3815.939 3801.854 3830.023 4482351.4 10076361 236352
#&gt; CP550 597.3710 597.3 597.4 3815.939 3801.854 3830.023 1671423.3  3664549  85456
#&gt;           maxf i        sn sample
#&gt; CP545 143788.3 1  74.16642      2
#&gt; CP546 291420.3 1  96.64179      2
#&gt; CP547 248172.4 1  96.65664      2
#&gt; CP548 547985.8 1 127.90477      2
#&gt; CP549 547303.6 1 138.11795      2
#&gt; CP550 198387.9 1  95.51380      2</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span>(<span class='fu'><a href='XCMSnExp-class.html'>chromPeaks</a></span>(<span class='no'>res_2</span>))</div><div class='output co'>#&gt;             mz mzmin mzmax       rt    rtmin    rtmax      into     intf   maxo
#&gt; CP545 593.3951 592.2 593.4 3685.926 3673.574 3696.757  881555.1  2243033 118256
#&gt; CP546 593.4661 593.4 593.5 3693.660 3679.746 3707.606 2446358.7  5385574 124240
#&gt; CP547 593.5000 593.5 593.5 3696.757 3684.380 3710.710 1702931.4  4186604 124240
#&gt; CP548 596.3343 596.3 596.4 3796.607 3782.484 3810.752 4482351.4 10099603 236352
#&gt; CP549 596.3343 596.3 596.4 3796.607 3782.484 3810.752 4482351.4 10076361 236352
#&gt; CP550 597.3710 597.3 597.4 3796.607 3782.484 3810.752 1671423.3  3664549  85456
#&gt;           maxf i        sn sample
#&gt; CP545 143788.3 1  74.16642      2
#&gt; CP546 291420.3 1  96.64179      2
#&gt; CP547 248172.4 1  96.65664      2
#&gt; CP548 547985.8 1 127.90477      2
#&gt; CP549 547303.6 1 138.11795      2
#&gt; CP550 198387.9 1  95.51380      2</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


