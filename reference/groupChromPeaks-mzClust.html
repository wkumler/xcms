<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>High resolution peak grouping for single spectra samples — groupChromPeaks-mzClust • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="High resolution peak grouping for single spectra samples — groupChromPeaks-mzClust" />
<meta property="og:description" content="This method performs high resolution correspondence for single spectra
samples.
The MzClustParam class allows to specify all settings for the peak
grouping based on the mzClust algorithm.
Instances should be created with the MzClustParam constructor.
sampleGroups,sampleGroups&amp;lt;-: getter and setter
for the sampleGroups slot of the object.
ppm,ppm&amp;lt;-: getter and setter for the ppm
slot of the object.
absMz,absMz&amp;lt;-: getter and setter for the
absMz slot of the object.
minFraction,minFraction&amp;lt;-: getter and setter for
the minFraction slot of the object.
minSamples,minSamples&amp;lt;-: getter and setter for the
minSamples slot of the object.
groupChromPeaks,XCMSnExp,MzClustParam: performs high resolution peak
grouping for single spectrum metabolomics data." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/new_functionality.html">New and modified functionality in xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>High resolution peak grouping for single spectra samples</h1>
    <small class="dont-index">Source: <a href='https://github.com/sneumann/xcms/blob/master/R/DataClasses.R'><code>R/DataClasses.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/functions-Params.R'><code>R/functions-Params.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/methods-Params.R'><code>R/methods-Params.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>groupChromPeaks-mzClust.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This method performs high resolution correspondence for single spectra
samples.</p>
<p>The <code>MzClustParam</code> class allows to specify all settings for the peak
grouping based on the <em>mzClust</em> algorithm.
Instances should be created with the <code>MzClustParam</code> constructor.</p>
<p><code>sampleGroups</code>,<code>sampleGroups&lt;-</code>: getter and setter
for the <code>sampleGroups</code> slot of the object.</p>
<p><code>ppm</code>,<code>ppm&lt;-</code>: getter and setter for the <code>ppm</code>
slot of the object.</p>
<p><code>absMz</code>,<code>absMz&lt;-</code>: getter and setter for the
<code>absMz</code> slot of the object.</p>
<p><code>minFraction</code>,<code>minFraction&lt;-</code>: getter and setter for
the <code>minFraction</code> slot of the object.</p>
<p><code>minSamples</code>,<code>minSamples&lt;-</code>: getter and setter for the
<code>minSamples</code> slot of the object.</p>
<p><code>groupChromPeaks,XCMSnExp,MzClustParam</code>: performs high resolution peak
grouping for single spectrum metabolomics data.</p>
    </div>

    <pre class="usage"><span class='fu'>MzClustParam</span>(
  <span class='kw'>sampleGroups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  <span class='kw'>ppm</span> <span class='kw'>=</span> <span class='fl'>20</span>,
  <span class='kw'>absMz</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>minFraction</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>minSamples</span> <span class='kw'>=</span> <span class='fl'>1</span>
)

<span class='co'># S4 method for MzClustParam</span>
<span class='fu'>show</span>(<span class='no'>object</span>)

<span class='co'># S4 method for MzClustParam</span>
<span class='fu'><a href='groupChromPeaks-density.html'>sampleGroups</a></span>(<span class='no'>object</span>)

<span class='co'># S4 method for MzClustParam</span>
<span class='fu'><a href='groupChromPeaks-density.html'>sampleGroups</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MzClustParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>ppm</a></span>(<span class='no'>object</span>)

<span class='co'># S4 method for MzClustParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>ppm</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MzClustParam</span>
<span class='fu'>absMz</span>(<span class='no'>object</span>)

<span class='co'># S4 method for MzClustParam</span>
<span class='fu'>absMz</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MzClustParam</span>
<span class='fu'><a href='groupChromPeaks-density.html'>minFraction</a></span>(<span class='no'>object</span>)

<span class='co'># S4 method for MzClustParam</span>
<span class='fu'><a href='groupChromPeaks-density.html'>minFraction</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MzClustParam</span>
<span class='fu'><a href='groupChromPeaks-density.html'>minSamples</a></span>(<span class='no'>object</span>)

<span class='co'># S4 method for MzClustParam</span>
<span class='fu'><a href='groupChromPeaks-density.html'>minSamples</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for XCMSnExp,MzClustParam</span>
<span class='fu'><a href='groupChromPeaks.html'>groupChromPeaks</a></span>(<span class='no'>object</span>, <span class='no'>param</span>, <span class='kw'>msLevel</span> <span class='kw'>=</span> <span class='fl'>1L</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sampleGroups</th>
      <td><p>A vector of the same length than samples defining the
sample group assignments (i.e. which samples belong to which sample
group). This parameter is mandatory for the <code>PeakDensityParam</code>
and has to be provided also if there is no sample grouping in the
experiment (in which case all samples should be assigned to the
same group).</p></td>
    </tr>
    <tr>
      <th>ppm</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> representing the relative mz error for the
clustering/grouping (in parts per million).</p></td>
    </tr>
    <tr>
      <th>absMz</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> representing the absolute mz error for the
clustering.</p></td>
    </tr>
    <tr>
      <th>minFraction</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the minimum fraction of samples
in at least one sample group in which the peaks have to be present to be
considered as a peak group (feature).</p></td>
    </tr>
    <tr>
      <th>minSamples</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> with the minimum number of samples in at
least one sample group in which the peaks have to be detected to be
considered a peak group (feature).</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>For <code>groupChromPeaks</code>: an <a href='XCMSnExp-class.html'>XCMSnExp</a> object containing the
results from a previous chromatographic peak detection analysis (see
<code><a href='chromatographic-peak-detection.html'>findChromPeaks()</a></code>).</p><pre>For all other methods: a `MzClustParam` object.
</pre></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>The value for the slot.</p></td>
    </tr>
    <tr>
      <th>param</th>
      <td><p>A <code>MzClustParam</code> object containing all settings for
the peak grouping algorithm.</p></td>
    </tr>
    <tr>
      <th>msLevel</th>
      <td><p><code><a href='https://rdrr.io/r/base/integer.html'>integer(1)</a></code> defining the MS level. Currently only MS level
1 is supported.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The <code>MzClustParam</code> function returns a <code>MzClustParam</code> class instance with
all of the settings specified for high resolution single spectra peak
alignment.</p>
<p>For <code>groupChromPeaks</code>: a <a href='XCMSnExp-class.html'>XCMSnExp</a> object with the results of the peak
grouping step (i.e. the features). These can be accessed with the
<code><a href='XCMSnExp-class.html'>featureDefinitions()</a></code> method.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl>
<dt><code>.__classVersion__,sampleGroups,ppm,absMz,minFraction,minSamples</code></dt><dd><p>See corresponding parameter above. <code>.__classVersion__</code> stores
the version from the class. Slots values should exclusively be accessed
<em>via</em> the corresponding getter and setter methods listed above.</p></dd>

</dl>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>These methods and classes are part of the updated and modernized
<code>xcms</code> user interface which will eventually replace the
<code><a href='group-methods.html'>group()</a></code> methods. All of the settings to the algorithm
can be passed with a MzClustParam object.</p>
<p>Calling <code>groupChromPeaks</code> on an <code>XCMSnExp</code> object will cause
all eventually present previous correspondence results to be dropped.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Saira A. Kazmi, Samiran Ghosh, Dong-Guk Shin, Dennis W. Hill
and David F. Grant<br /> Alignment of high resolution mass spectra:
development of a heuristic approach for metabolomics.<br /> Metabolomics,
Vol. 2, No. 2, 75-83 (2006)</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The <code><a href='do_groupPeaks_mzClust.html'>do_groupPeaks_mzClust()</a></code> core API function and <code><a href='group.mzClust.html'>group.mzClust()</a></code> for
the old user interface.</p>
<p><code><a href='XCMSnExp-class.html'>featureDefinitions()</a></code> and <code><a href='XCMSnExp-peak-grouping-results.html'>featureValues()</a></code> for methods to access peak
grouping results (i.e. the features).</p>
<p><a href='XCMSnExp-class.html'>XCMSnExp</a> for the object containing the results of
the peak grouping.</p>
<p>Other peak grouping methods: 
<code><a href='groupChromPeaks-density.html'>groupChromPeaks-density</a></code>,
<code><a href='groupChromPeaks-nearest.html'>groupChromPeaks-nearest</a></code>,
<code><a href='groupChromPeaks.html'>groupChromPeaks</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Loading a small subset of direct injection, single spectrum files</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>msdata</span>)
<span class='no'>fticrf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"fticr"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"msdata"</span>),
                    <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>fticr</span> <span class='kw'>&lt;-</span> <span class='fu'>readMSData</span>(<span class='no'>fticrf</span>[<span class='fl'>1</span>:<span class='fl'>2</span>], <span class='kw'>msLevel.</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"onDisk"</span>)

<span class='co'>## Perform the MSW peak detection on these:</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='findPeaks-MSW.html'>MSWParam</a></span>(<span class='kw'>scales</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>7</span>), <span class='kw'>peakThr</span> <span class='kw'>=</span> <span class='fl'>80000</span>, <span class='kw'>ampTh</span> <span class='kw'>=</span> <span class='fl'>0.005</span>,
             <span class='kw'>SNR.method</span> <span class='kw'>=</span> <span class='st'>"data.mean"</span>, <span class='kw'>winSize.noise</span> <span class='kw'>=</span> <span class='fl'>500</span>)
<span class='no'>fticr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span>(<span class='no'>fticr</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='no'>p</span>)

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='XCMSnExp-class.html'>chromPeaks</a></span>(<span class='no'>fticr</span>))</div><div class='output co'>#&gt;            mz    mzmin    mzmax rt rtmin rtmax    into     maxo        sn intf
#&gt; CP01 403.2367 403.2279 403.2447 -1    -1    -1 4735258 372259.4 22.975342   NA
#&gt; CP02 409.1845 409.1755 409.1936 -1    -1    -1 4158404 310572.1 20.597978   NA
#&gt; CP03 413.2677 413.2585 413.2769 -1    -1    -1 6099006 435462.6 27.217229   NA
#&gt; CP04 414.2719 414.2652 414.2786 -1    -1    -1 1916658 157613.1  8.777433   NA
#&gt; CP05 423.2363 423.2266 423.2459 -1    -1    -1 2708391 174252.7 14.745275   NA
#&gt; CP06 427.2681 427.2583 427.2779 -1    -1    -1 6302089 461385.6 32.468892   NA
#&gt;           maxf sample
#&gt; CP01  814693.1      1
#&gt; CP02  731557.2      1
#&gt; CP03 1018994.8      1
#&gt; CP04  280826.9      1
#&gt; CP05  435858.5      1
#&gt; CP06 1124549.4      1</div><div class='input'>
<span class='co'>## Now create the MzClustParam parameter object: we're assuming here that</span>
<span class='co'>## both samples are from the same sample group.</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'>MzClustParam</span>(<span class='kw'>sampleGroups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>))

<span class='no'>fticr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='groupChromPeaks.html'>groupChromPeaks</a></span>(<span class='no'>fticr</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='no'>p</span>)</div><div class='output co'>#&gt; 8.00  16.00  24.00  28.00  32.00  40.00  48.00  52.00  56.00  60.00  64.00  72.00  80.00  84.00  88.00  96.00  100.00  </div><div class='input'>
<span class='co'>## Get the definition of the features.</span>
<span class='fu'><a href='XCMSnExp-class.html'>featureDefinitions</a></span>(<span class='no'>fticr</span>)</div><div class='output co'>#&gt; DataFrame with 17 rows and 9 columns
#&gt;          mzmed     mzmin     mzmax     rtmed     rtmin     rtmax    npeaks
#&gt;      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
#&gt; FT01   403.237   403.237   403.237        -1        -1        -1         2
#&gt; FT02   409.184   409.184   409.185        -1        -1        -1         2
#&gt; FT03   413.267   413.267   413.268        -1        -1        -1         2
#&gt; FT04   414.272   414.272   414.272        -1        -1        -1         1
#&gt; FT05   419.213   419.213   419.213        -1        -1        -1         1
#&gt; ...        ...       ...       ...       ...       ...       ...       ...
#&gt; FT13   438.240   438.240   438.240        -1        -1        -1         2
#&gt; FT14   443.241   443.241   443.241        -1        -1        -1         1
#&gt; FT15   443.336   443.336   443.336        -1        -1        -1         1
#&gt; FT16   445.293   445.292   445.293        -1        -1        -1         2
#&gt; FT17   447.297   447.297   447.297        -1        -1        -1         1
#&gt;             X1 peakidx
#&gt;      &lt;numeric&gt;  &lt;list&gt;
#&gt; FT01         2    1,13
#&gt; FT02         2    14,2
#&gt; FT03         2    15,3
#&gt; FT04         1       4
#&gt; FT05         1      16
#&gt; ...        ...     ...
#&gt; FT13         2   10,22
#&gt; FT14         1      11
#&gt; FT15         1      23
#&gt; FT16         2   24,12
#&gt; FT17         1      25</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


