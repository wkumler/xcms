<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot chromatographic peak density along the retention time axis — plotChromPeakDensity,XCMSnExp-method • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot chromatographic peak density along the retention time axis — plotChromPeakDensity,XCMSnExp-method" />
<meta property="og:description" content="Plot the density of chromatographic peaks along the retention
time axis and indicate which peaks would be (or were) grouped into the
same feature based using the peak density correspondence method.
Settings for the peak density method can be passed with an
PeakDensityParam object to parameter param. If the object contains
correspondence results and the correspondence was performed with the
peak groups method, the results from that correspondence can be
visualized setting simulate = FALSE." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/new_functionality.html">New and modified functionality in xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot chromatographic peak density along the retention time axis</h1>
    <small class="dont-index">Source: <a href='https://github.com/sneumann/xcms/blob/master/R/methods-XCMSnExp.R'><code>R/methods-XCMSnExp.R</code></a></small>
    <div class="hidden name"><code>plotChromPeakDensity.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plot the density of chromatographic peaks along the retention
time axis and indicate which peaks would be (or were) grouped into the
same feature based using the <em>peak density</em> correspondence method.
Settings for the <em>peak density</em> method can be passed with an
<a href='groupChromPeaks-density.html'>PeakDensityParam</a> object to parameter <code>param</code>. If the <code>object</code> contains
correspondence results and the correspondence was performed with the
<em>peak groups</em> method, the results from that correspondence can be
visualized setting <code>simulate = FALSE</code>.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>plotChromPeakDensity</span>(
  <span class='no'>object</span>,
  <span class='no'>mz</span>,
  <span class='no'>rt</span>,
  <span class='no'>param</span>,
  <span class='kw'>simulate</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"#00000080"</span>,
  <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"retention time"</span>,
  <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"sample"</span>,
  <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='no'>rt</span>),
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"any"</span>, <span class='st'>"within"</span>, <span class='st'>"apex_within"</span>),
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A <a href='XCMSnExp-class.html'>XCMSnExp</a> object with identified
chromatographic peaks.</p></td>
    </tr>
    <tr>
      <th>mz</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code> defining an mz range for which the peak density
should be plotted.</p></td>
    </tr>
    <tr>
      <th>rt</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code> defining an optional rt range for which the
peak density should be plotted. Defaults to the absolute retention time
range of <code>object</code>.</p></td>
    </tr>
    <tr>
      <th>param</th>
      <td><p><a href='groupChromPeaks-density.html'>PeakDensityParam</a> from which parameters for the
<em>peak density</em> correspondence algorithm can be extracted. If not provided
and if <code>object</code> contains feature definitions with the correspondence/
peak grouping being performed by the <em>peak density</em> method, the
corresponding parameter class stored in <code>object</code> is used.</p></td>
    </tr>
    <tr>
      <th>simulate</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> defining whether correspondence should be
simulated within the specified m/z / rt region or (with
<code>simulate = FALSE</code>) whether the results from an already performed
correspondence should be shown.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>Color to be used for the individual samples. Length has to be 1
or equal to the number of samples in <code>object</code>.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> with the label for the x-axis.</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> with the label for the y-axis.</p></td>
    </tr>
    <tr>
      <th>xlim</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code> representing the limits for the x-axis.
Defaults to the range of the <code>rt</code> parameter.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> defining the title of the plot. By default
(for <code>main = NULL</code>) the mz-range is used.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> specifying how peaks are called to be located
within the region defined by <code>mz</code> and <code>rt</code>. Can be one of <code>"any"</code>,
<code>"within"</code>, and <code>"apex_within"</code> for all peaks that are even partially
overlapping the region, peaks that are completely within the region, and
peaks for which the apex is within the region. This parameter is passed
to the <a href='XCMSnExp-class.html'>chromPeaks</a> function. See related documentation for more
information and examples.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters to be passed to the <code>plot</code> function. Data
point specific parameters such as <code>bg</code> or <code>pch</code> have to be of length 1
or equal to the number of samples.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function is called for its side effect, i.e. to create a plot.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>plotChromPeakDensity</code> function allows to evaluate
different settings for the <em>peak density</em> on an mz slice of
interest (e.g. containing chromatographic peaks corresponding to a known
metabolite).
The plot shows the individual peaks that were detected within the
specified <code>mz</code> slice at their retention time (x-axis) and sample in
which they were detected (y-axis). The density function is plotted as a
black line. Parameters for the <code>density</code> function are taken from the
<code>param</code> object. Grey rectangles indicate which chromatographic peaks
would be grouped into a feature by the <code>peak density</code> correspondence
method. Parameters for the algorithm are also taken from <code>param</code>.
See <code><a href='groupChromPeaks-density.html'>groupChromPeaks-density()</a></code> for more information about the
algorithm and its supported settings.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='groupChromPeaks-density.html'>groupChromPeaks-density()</a></code> for details on the
<em>peak density</em> correspondence method and supported settings.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Below we perform first a peak detection (using the centWave</span>
<span class='co'>## method) on some of the test files from the faahKO package.</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>faahKO</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>xcms</span>)
<span class='no'>fls</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>dir</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"cdf/KO"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"faahKO"</span>), <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
           <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>## Reading 2 of the KO samples</span>
<span class='no'>raw_data</span> <span class='kw'>&lt;-</span> <span class='fu'>readMSData</span>(<span class='no'>fls</span>[<span class='fl'>1</span>:<span class='fl'>2</span>], <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"onDisk"</span>)</div><div class='output co'>#&gt; <span class='message'>Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span></div><div class='input'>
<span class='co'>## Perform the peak detection using the centWave method (settings are tuned</span>
<span class='co'>## to speed up example execution)</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span>(<span class='no'>raw_data</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'><a href='findChromPeaks-centWave.html'>CentWaveParam</a></span>(<span class='kw'>noise</span> <span class='kw'>=</span> <span class='fl'>3000</span>, <span class='kw'>snthresh</span> <span class='kw'>=</span> <span class='fl'>40</span>))</div><div class='output co'>#&gt; <span class='message'>Detecting mass traces at 25 ppm ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Detecting chromatographic peaks in 4011 regions of interest ...</span></div><div class='output co'>#&gt; <span class='message'> OK: 157 found.</span></div><div class='output co'>#&gt; <span class='message'>Detecting mass traces at 25 ppm ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Detecting chromatographic peaks in 4512 regions of interest ...</span></div><div class='output co'>#&gt; <span class='message'> OK: 196 found.</span></div><div class='input'>
<span class='co'>## Align the samples using obiwarp</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='adjustRtime.html'>adjustRtime</a></span>(<span class='no'>res</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'><a href='adjustRtime-obiwarp.html'>ObiwarpParam</a></span>())</div><div class='output co'>#&gt; <span class='message'>Sample number 1 used as center sample.</span></div><div class='output co'>#&gt; <span class='message'>Aligning ko16.CDF against ko15.CDF ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Applying retention time adjustment to the identified chromatographic peaks ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='co'>## Plot the chromatographic peak density for a specific mz range to evaluate</span>
<span class='co'>## different peak density correspondence settings.</span>
<span class='no'>mzr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>305.05</span>, <span class='fl'>305.15</span>)

<span class='fu'>plotChromPeakDensity</span>(<span class='no'>res</span>, <span class='kw'>mz</span> <span class='kw'>=</span> <span class='no'>mzr</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>16</span>,
    <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'><a href='groupChromPeaks-density.html'>PeakDensityParam</a></span>(<span class='kw'>sampleGroups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='fu'>fileNames</span>(<span class='no'>res</span>)))))</div><div class='output co'>#&gt; <span class='warning'>Warning: Use of 'plotChromPeakDensity' on 'XCMSnExp' isdiscouraged. Please extract chromatographic data first and call 'plotChromPeakDensity' directly on the 'XChromatograms' object. See ?XChromatograms, section 'Correspondence analysis' for more details.</span></div><div class='img'><img src='plotChromPeakDensity-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Use a larger bandwidth</span>
<span class='fu'>plotChromPeakDensity</span>(<span class='no'>res</span>, <span class='kw'>mz</span> <span class='kw'>=</span> <span class='no'>mzr</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'><a href='groupChromPeaks-density.html'>PeakDensityParam</a></span>(<span class='kw'>bw</span> <span class='kw'>=</span> <span class='fl'>60</span>,
    <span class='kw'>sampleGroups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='fu'>fileNames</span>(<span class='no'>res</span>)))), <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>16</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Use of 'plotChromPeakDensity' on 'XCMSnExp' isdiscouraged. Please extract chromatographic data first and call 'plotChromPeakDensity' directly on the 'XChromatograms' object. See ?XChromatograms, section 'Correspondence analysis' for more details.</span></div><div class='img'><img src='plotChromPeakDensity-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Neighboring peaks are now fused into one.</span>

<span class='co'>## Require the chromatographic peak to be present in all samples of a group</span>
<span class='fu'>plotChromPeakDensity</span>(<span class='no'>res</span>, <span class='kw'>mz</span> <span class='kw'>=</span> <span class='no'>mzr</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>16</span>,
    <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'><a href='groupChromPeaks-density.html'>PeakDensityParam</a></span>(<span class='kw'>minFraction</span> <span class='kw'>=</span> <span class='fl'>1</span>,
    <span class='kw'>sampleGroups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='fu'>fileNames</span>(<span class='no'>res</span>)))))</div><div class='output co'>#&gt; <span class='warning'>Warning: Use of 'plotChromPeakDensity' on 'XCMSnExp' isdiscouraged. Please extract chromatographic data first and call 'plotChromPeakDensity' directly on the 'XChromatograms' object. See ?XChromatograms, section 'Correspondence analysis' for more details.</span></div><div class='img'><img src='plotChromPeakDensity-3.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


