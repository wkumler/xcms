<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Single-spectrum non-chromatography MS data peak detection — findPeaks-MSW • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Single-spectrum non-chromatography MS data peak detection — findPeaks-MSW" />
<meta property="og:description" content="Perform peak detection in mass spectrometry
    direct injection spectrum using a wavelet based algorithm.
The MSWParam class allows to specify all
    settings for a peak detection using the MSW method. Instances should be
    created with the MSWParam constructor.
The findChromPeaks,OnDiskMSnExp,MSWParam
    method performs peak detection in single-spectrum non-chromatography MS
    data using functionality from the MassSpecWavelet package on all
    samples from an OnDiskMSnExp object.
    OnDiskMSnExp objects encapsule all experiment
    specific data and load the spectra data (mz and intensity values) on the
    fly from the original files applying also all eventual data
    manipulations.
snthresh,snthresh&amp;lt;-: getter and setter for the
    snthresh slot of the object.
verboseColumns,verboseColumns&amp;lt;-: getter and setter
    for the verboseColumns slot of the object.
scales,scales&amp;lt;-: getter and setter for the
    scales slot of the object.
nearbyPeak,nearbyPeak&amp;lt;-: getter and setter for the
    nearbyPeak slot of the object.
peakScaleRange,peakScaleRange&amp;lt;-: getter and setter
    for the peakScaleRange slot of the object.
ampTh,ampTh&amp;lt;-: getter and setter for the
    ampTh slot of the object.
minNoiseLevel,minNoiseLevel&amp;lt;-: getter and setter
    for the minNoiseLevel slot of the object.
ridgeLength,ridgeLength&amp;lt;-: getter and setter for
    the ridgeLength slot of the object.
peakThr,peakThr&amp;lt;-: getter and setter for the
    peakThr slot of the object.
tuneIn,tuneIn&amp;lt;-: getter and setter for the
    tuneIn slot of the object.
addParams,addParams&amp;lt;-: getter and setter for the
    addParams slot of the object. This slot stores optional additional
    parameters to be passed to the
    identifyMajorPeaks and
    sav.gol functions from the
    MassSpecWavelet package." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.13.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Single-spectrum non-chromatography MS data peak detection</h1>
    <small class="dont-index">Source: <a href='https://github.com/sneumann/xcms/blob/master/R/DataClasses.R'><code>R/DataClasses.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/functions-Params.R'><code>R/functions-Params.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/methods-OnDiskMSnExp.R'><code>R/methods-OnDiskMSnExp.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>findPeaks-MSW.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform peak detection in mass spectrometry
    direct injection spectrum using a wavelet based algorithm.</p>
<p>The <code>MSWParam</code> class allows to specify all
    settings for a peak detection using the MSW method. Instances should be
    created with the <code>MSWParam</code> constructor.</p>
<p>The <code>findChromPeaks,OnDiskMSnExp,MSWParam</code>
    method performs peak detection in single-spectrum non-chromatography MS
    data using functionality from the <code>MassSpecWavelet</code> package on all
    samples from an <code><a href='https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html'>OnDiskMSnExp</a></code> object.
    <code><a href='https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html'>OnDiskMSnExp</a></code> objects encapsule all experiment
    specific data and load the spectra data (mz and intensity values) on the
    fly from the original files applying also all eventual data
    manipulations.</p>
<p><code>snthresh</code>,<code>snthresh&lt;-</code>: getter and setter for the
    <code>snthresh</code> slot of the object.</p>
<p><code>verboseColumns</code>,<code>verboseColumns&lt;-</code>: getter and setter
    for the <code>verboseColumns</code> slot of the object.</p>
<p><code>scales</code>,<code>scales&lt;-</code>: getter and setter for the
    <code>scales</code> slot of the object.</p>
<p><code>nearbyPeak</code>,<code>nearbyPeak&lt;-</code>: getter and setter for the
    <code>nearbyPeak</code> slot of the object.</p>
<p><code>peakScaleRange</code>,<code>peakScaleRange&lt;-</code>: getter and setter
    for the <code>peakScaleRange</code> slot of the object.</p>
<p><code>ampTh</code>,<code>ampTh&lt;-</code>: getter and setter for the
    <code>ampTh</code> slot of the object.</p>
<p><code>minNoiseLevel</code>,<code>minNoiseLevel&lt;-</code>: getter and setter
    for the <code>minNoiseLevel</code> slot of the object.</p>
<p><code>ridgeLength</code>,<code>ridgeLength&lt;-</code>: getter and setter for
    the <code>ridgeLength</code> slot of the object.</p>
<p><code>peakThr</code>,<code>peakThr&lt;-</code>: getter and setter for the
    <code>peakThr</code> slot of the object.</p>
<p><code>tuneIn</code>,<code>tuneIn&lt;-</code>: getter and setter for the
    <code>tuneIn</code> slot of the object.</p>
<p><code>addParams</code>,<code>addParams&lt;-</code>: getter and setter for the
    <code>addParams</code> slot of the object. This slot stores optional additional
    parameters to be passed to the
    <code>identifyMajorPeaks</code> and
    <code>sav.gol</code> functions from the
    <code>MassSpecWavelet</code> package.</p>
    </div>

    <pre class="usage"><span class='fu'>MSWParam</span><span class='op'>(</span>
  snthresh <span class='op'>=</span> <span class='fl'>3</span>,
  verboseColumns <span class='op'>=</span> <span class='cn'>FALSE</span>,
  scales <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>30</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>32</span>, <span class='fl'>64</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>,
  nearbyPeak <span class='op'>=</span> <span class='cn'>TRUE</span>,
  peakScaleRange <span class='op'>=</span> <span class='fl'>5</span>,
  ampTh <span class='op'>=</span> <span class='fl'>0.01</span>,
  minNoiseLevel <span class='op'>=</span> <span class='va'>ampTh</span><span class='op'>/</span><span class='va'>snthresh</span>,
  ridgeLength <span class='op'>=</span> <span class='fl'>24</span>,
  peakThr <span class='op'>=</span> <span class='cn'>NULL</span>,
  tuneIn <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for OnDiskMSnExp,MSWParam</span>
<span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>param</span>,
  BPPARAM <span class='op'>=</span> <span class='fu'>bpparam</span><span class='op'>(</span><span class='op'>)</span>,
  return.type <span class='op'>=</span> <span class='st'>"XCMSnExp"</span>,
  msLevel <span class='op'>=</span> <span class='fl'>1L</span>
<span class='op'>)</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>snthresh</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>snthresh</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>verboseColumns</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>verboseColumns</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>scales</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>scales</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>nearbyPeak</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>nearbyPeak</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>peakScaleRange</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>peakScaleRange</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>ampTh</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>ampTh</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>minNoiseLevel</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>minNoiseLevel</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>ridgeLength</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>ridgeLength</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>peakThr</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>peakThr</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>tuneIn</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>tuneIn</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>addParams</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for MSWParam</span>
<span class='fu'>addParams</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>value</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>snthresh</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the signal to noise ratio cutoff.</p></td>
    </tr>
    <tr>
      <th>verboseColumns</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether additional peak meta data
columns should be returned.</p></td>
    </tr>
    <tr>
      <th>scales</th>
      <td><p>Numeric defining the scales of the continuous wavelet
transform (CWT).</p></td>
    </tr>
    <tr>
      <th>nearbyPeak</th>
      <td><p>logical(1) whether to include nearby peaks of
major peaks.</p></td>
    </tr>
    <tr>
      <th>peakScaleRange</th>
      <td><p>numeric(1) defining the scale range of the
peak (larger than 5 by default).</p></td>
    </tr>
    <tr>
      <th>ampTh</th>
      <td><p>numeric(1) defining the minimum required relative
amplitude of the peak (ratio of the maximum of CWT coefficients).</p></td>
    </tr>
    <tr>
      <th>minNoiseLevel</th>
      <td><p>numeric(1) defining the minimum noise level
used in computing the SNR.</p></td>
    </tr>
    <tr>
      <th>ridgeLength</th>
      <td><p>numeric(1) defining the minimum highest scale
of the peak in 2-D CWT coefficient matrix.</p></td>
    </tr>
    <tr>
      <th>peakThr</th>
      <td><p>numeric(1) with the minimum absolute intensity
(above baseline) of peaks to be picked. If provided, the smoothing
function <code>sav.gol</code> function (in the <code>MassSpecWavelet</code>)
package is called to estimate the local intensity.</p></td>
    </tr>
    <tr>
      <th>tuneIn</th>
      <td><p>logical(1) whther to tune in the parameter
estimation of the detected peaks.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters to be passed to the
<code>identifyMajorPeaks</code> and
<code>sav.gol</code> functions from the
<code>MassSpecWavelet</code> package.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>For <code>findChromPeaks</code>: an
    <code><a href='https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html'>OnDiskMSnExp</a></code> object containing the MS- and all
    other experiment-relevant data.</p>
<p>For all other methods: a parameter object.</p></td>
    </tr>
    <tr>
      <th>param</th>
      <td><p>An <code>MSWParam</code> object containing all settings for
the algorithm.</p></td>
    </tr>
    <tr>
      <th>BPPARAM</th>
      <td><p>A parameter class specifying if and how parallel processing
should be performed. It defaults to <code>bpparam</code>.
See documentation of the <code>BiocParallel</code> for more details. If
parallel processing is enabled, peak detection is performed in parallel
on several of the input samples.</p></td>
    </tr>
    <tr>
      <th>return.type</th>
      <td><p>Character specifying what type of object the method should
return. Can be either <code>"XCMSnExp"</code> (default), <code>"list"</code> or
<code>"xcmsSet"</code>.</p></td>
    </tr>
    <tr>
      <th>msLevel</th>
      <td><p><code><a href='https://rdrr.io/r/base/integer.html'>integer(1)</a></code> defining the MS level on which the peak
detection should be performed. Defaults to <code>msLevel = 1</code>.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>The value for the slot.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The <code>MSWParam</code> function returns a <code>MSWParam</code>
    class instance with all of the settings specified for peak detection by
    the <em>MSW</em> method.</p>
<p>For <code>findChromPeaks</code>: if <code>return.type = "XCMSnExp"</code> an
    <code><a href='XCMSnExp-class.html'>XCMSnExp</a></code> object with the results of the peak detection.
    If <code>return.type = "list"</code> a list of length equal to the number of
    samples with matrices specifying the identified peaks.
    If <code>return.type = "xcmsSet"</code> an <code><a href='xcmsSet-class.html'>xcmsSet</a></code> object
    with the results of the detection.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is a wrapper for the peak picker in Bioconductor's
    <code>MassSpecWavelet</code> package calling
    <code>peakDetectionCWT</code> and
    <code>tuneInPeakInfo</code> functions. See the
    <em>xcmsDirect</em> vignette for more information.</p>
<p>Parallel processing (one process per sample) is supported and can
    be configured either by the <code>BPPARAM</code> parameter or by globally
    defining the parallel processing mode using the
    <code>register</code> method from the <code>BiocParallel</code>
    package.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl>
<dt><code>snthresh,verboseColumns,scales,nearbyPeak,peakScaleRange,ampTh,minNoiseLevel,ridgeLength,peakThr,tuneIn,addParams</code></dt><dd><p>See corresponding parameter above.</p></dd>

</dl>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>These methods and classes are part of the updated and modernized
    <code>xcms</code> user interface which will eventually replace the
    <code><a href='findPeaks-methods.html'>findPeaks</a></code> methods. It supports peak detection on
    <code><a href='https://lgatto.github.io/MSnbase/reference/OnDiskMSnExp-class.html'>OnDiskMSnExp</a></code>
    objects (defined in the <code>MSnbase</code> package). All of the settings
    to the algorithm can be passed with a <code>MSWParam</code> object.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The <code><a href='do_findPeaks_MSW.html'>do_findPeaks_MSW</a></code> core API function
    and <code><a href='findPeaks.MSW,xcmsRaw-method.html'>findPeaks.MSW</a></code> for the old user interface.</p>
<p><code><a href='XCMSnExp-class.html'>XCMSnExp</a></code> for the object containing the results of
    the peak detection.</p>
<p>Other peak detection methods: 
<code><a href='chromatographic-peak-detection.html'>chromatographic-peak-detection</a></code>,
<code><a href='findChromPeaks-centWaveWithPredIsoROIs.html'>findChromPeaks-centWaveWithPredIsoROIs</a></code>,
<code><a href='findChromPeaks-centWave.html'>findChromPeaks-centWave</a></code>,
<code><a href='findChromPeaks-massifquant.html'>findChromPeaks-massifquant</a></code>,
<code><a href='findChromPeaks-matchedFilter.html'>findChromPeaks-matchedFilter</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Joachim Kutzera, Steffen Neumann, Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Create a MSWParam object</span>
<span class='va'>mp</span> <span class='op'>&lt;-</span> <span class='fu'>MSWParam</span><span class='op'>(</span><span class='op'>)</span>
<span class='co'>## Change snthresh parameter</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>snthresh</a></span><span class='op'>(</span><span class='va'>mp</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fl'>15</span>
<span class='va'>mp</span>
</div><div class='output co'>#&gt; Object of class:  MSWParam 
#&gt;  Parameters:
#&gt;  - snthresh: [1] 15
#&gt;  - verboseColumns: [1] FALSE
#&gt;  - scales:  [1]  1  2  4  6  8 10 12 14 16 18 20 22 24 26 28 30 32 36 40 44 48 52 56 60 64
#&gt;  - nearbyPeak: [1] TRUE
#&gt;  - peakScaleRange: [1] 5
#&gt;  - amp.Th: [1] 0.01
#&gt;  - minNoiseLevel: [1] 0.003333333
#&gt;  - ridgeLength: [1] 24
#&gt;  - peakThr: numeric(0)
#&gt;  - tuneIn: [1] FALSE</div><div class='input'>
<span class='co'>## Loading a small subset of direct injection, single spectrum files</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>msdata</span><span class='op'>)</span>
<span class='va'>fticrf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"fticr"</span>, package <span class='op'>=</span> <span class='st'>"msdata"</span><span class='op'>)</span>,
                    recursive <span class='op'>=</span> <span class='cn'>TRUE</span>, full.names <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>fticr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://lgatto.github.io/MSnbase/reference/readMSData.html'>readMSData</a></span><span class='op'>(</span><span class='va'>fticrf</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, msLevel. <span class='op'>=</span> <span class='fl'>1</span>, mode <span class='op'>=</span> <span class='st'>"onDisk"</span><span class='op'>)</span>

<span class='co'>## Perform the MSW peak detection on these:</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'>MSWParam</span><span class='op'>(</span>scales <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>7</span><span class='op'>)</span>, peakThr <span class='op'>=</span> <span class='fl'>80000</span>, ampTh <span class='op'>=</span> <span class='fl'>0.005</span>,
             SNR.method <span class='op'>=</span> <span class='st'>"data.mean"</span>, winSize.noise <span class='op'>=</span> <span class='fl'>500</span><span class='op'>)</span>
<span class='va'>fticr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span><span class='op'>(</span><span class='va'>fticr</span>, param <span class='op'>=</span> <span class='va'>p</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='XCMSnExp-class.html'>chromPeaks</a></span><span class='op'>(</span><span class='va'>fticr</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            mz    mzmin    mzmax rt rtmin rtmax    into     maxo        sn intf
#&gt; CP01 403.2367 403.2279 403.2447 -1    -1    -1 4735258 372259.4 22.975342   NA
#&gt; CP02 409.1845 409.1755 409.1936 -1    -1    -1 4158404 310572.1 20.597978   NA
#&gt; CP03 413.2677 413.2585 413.2769 -1    -1    -1 6099006 435462.6 27.217229   NA
#&gt; CP04 414.2719 414.2652 414.2786 -1    -1    -1 1916658 157613.1  8.777433   NA
#&gt; CP05 423.2363 423.2266 423.2459 -1    -1    -1 2708391 174252.7 14.745275   NA
#&gt; CP06 427.2681 427.2583 427.2779 -1    -1    -1 6302089 461385.6 32.468892   NA
#&gt;           maxf sample
#&gt; CP01  814693.1      1
#&gt; CP02  731557.2      1
#&gt; CP03 1018994.8      1
#&gt; CP04  280826.9      1
#&gt; CP05  435858.5      1
#&gt; CP06 1124549.4      1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Steffen Neumann.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9000.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


