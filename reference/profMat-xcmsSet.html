<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The profile matrix — profMat-xcmsSet • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="The profile matrix — profMat-xcmsSet" />
<meta property="og:description" content="The profile matrix is an n x m matrix, n (rows)
    representing equally spaced m/z values (bins) and m (columns) the
    retention time of the corresponding scans. Each cell contains the maximum
    intensity measured for the specific scan and m/z values falling within
    the m/z bin.
The profMat method creates a new profile matrix or returns the
    profile matrix within the object's @env slot, if available.
    Settings for the profile matrix generation, such as step (the bin
    size), method or additional settings are extracted from the
    respective slots of the xcmsRaw object.
    Alternatively it is possible to specify all of the settings as
    additional parameters." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/new_functionality.html">New and modified functionality in xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>The profile matrix</h1>
    <small class="dont-index">Source: <a href='https://github.com/sneumann/xcms/blob/master/R/methods-xcmsRaw.R'><code>R/methods-xcmsRaw.R</code></a></small>
    <div class="hidden name"><code>profMat-xcmsSet.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <em>profile</em> matrix is an n x m matrix, n (rows)
    representing equally spaced m/z values (bins) and m (columns) the
    retention time of the corresponding scans. Each cell contains the maximum
    intensity measured for the specific scan and m/z values falling within
    the m/z bin.</p>
<p>The <code>profMat</code> method creates a new profile matrix or returns the
    profile matrix within the object's <code>@env</code> slot, if available.
    Settings for the profile matrix generation, such as <code>step</code> (the bin
    size), <code>method</code> or additional settings are extracted from the
    respective slots of the <code><a href='xcmsRaw-class.html'>xcmsRaw</a></code> object.
    Alternatively it is possible to specify all of the settings as
    additional parameters.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for xcmsRaw</span>
<span class='fu'>profMat</span>(<span class='no'>object</span>, <span class='no'>method</span>, <span class='no'>step</span>, <span class='no'>baselevel</span>, <span class='no'>basespace</span>, <span class='no'>mzrange.</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>The <code><a href='xcmsRaw-class.html'>xcmsRaw</a></code> object.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>The profile matrix generation method. Allowed are <code>"bin"</code>,
<code>"binlin"</code>, <code>"binlinbase"</code> and <code>"intlin"</code>. See details
section for more information.</p></td>
    </tr>
    <tr>
      <th>step</th>
      <td><p>numeric(1) representing the m/z bin size.</p></td>
    </tr>
    <tr>
      <th>baselevel</th>
      <td><p>numeric(1) representing the base value to which
empty elements (i.e. m/z bins without a measured intensity) should be
set. Only considered if <code>method = "binlinbase"</code>. See
<code>baseValue</code> parameter of <code><a href='imputeLinInterpol.html'>imputeLinInterpol</a></code> for more
details.</p></td>
    </tr>
    <tr>
      <th>basespace</th>
      <td><p>numeric(1) representing the m/z length after
which the signal will drop to the base level. Linear interpolation will
be used between consecutive data points falling within
<code>2 * basespace</code> to each other. Only considered if
<code>method = "binlinbase"</code>. If not specified, it defaults to
<code>0.075</code>. Internally this parameter is translated into the
<code>distance</code> parameter of the <code><a href='imputeLinInterpol.html'>imputeLinInterpol</a></code>
function by <code>distance = floor(basespace / step)</code>. See
<code>distance</code> parameter of <code><a href='imputeLinInterpol.html'>imputeLinInterpol</a></code> for more
details.</p></td>
    </tr>
    <tr>
      <th>mzrange.</th>
      <td><p>Optional numeric(2) manually specifying the mz value range to
be used for binnind. If not provided, the whole mz value range is used.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>profMat</code> returns the profile matrix (rows representing scans,
    columns equally spaced m/z values).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Profile matrix generation methods:</p><dl>
    <dt>bin</dt><dd><p>The default profile matrix generation method that does a
    simple binning, i.e. aggregating of intensity values falling within an
    m/z bin.</p></dd>
    <dt>binlin</dt><dd><p>Binning followed by linear interpolation to impute missing
    values. The value for m/z bins without a measured intensity are inferred
    by a linear interpolation between neighboring bins with a measured
    intensity.</p></dd>
    <dt>binlinbase</dt><dd><p>Binning followed by a linear interpolation to impute
    values for empty elements (m/z bins) within a user-definable proximity to
    non-empty elements while stetting the element's value to the
    <code>baselevel</code> otherwise. See <code>impute = "linbase"</code> parameter of
    <code><a href='imputeLinInterpol.html'>imputeLinInterpol</a></code> for more details.</p></dd>
    <dt>intlin</dt><dd><p>Set the elements' values to the integral of the linearly
    interpolated data from plus to minus half the step size.</p></dd>
    
</dl>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>From <code>xcms</code> version 1.51.1 on only the <code>profMat</code> method
    should be used to extract the profile matrix instead of the previously
    default way to access it directly <em>via</em> <code>object@env$profile</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='xcmsRaw-class.html'>xcmsRaw</a></code>, <code><a href='binYonX.html'>binYonX</a></code> and
    <code><a href='imputeLinInterpol.html'>imputeLinInterpol</a></code> for the employed binning and
    missing value imputation methods, respectively.
    <code><a href='XCMSnExp-class.html'>profMat,XCMSnExp-method</a></code> for the method on
    <code><a href='XCMSnExp-class.html'>XCMSnExp</a></code> objects.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>file</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>'cdf/KO/ko15.CDF'</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"faahKO"</span>)
<span class='co'>## Load the data without generating the profile matrix (profstep = 0)</span>
<span class='no'>xraw</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='xcmsRaw.html'>xcmsRaw</a></span>(<span class='no'>file</span>, <span class='kw'>profstep</span> <span class='kw'>=</span> <span class='fl'>0</span>)
<span class='co'>## Extract the profile matrix</span>
<span class='no'>profmat</span> <span class='kw'>&lt;-</span> <span class='fu'>profMat</span>(<span class='no'>xraw</span>, <span class='kw'>step</span> <span class='kw'>=</span> <span class='fl'>0.3</span>)</div><div class='output co'>#&gt; <span class='message'>Create profile matrix with method 'bin' and step 0.3 ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span>(<span class='no'>profmat</span>)</div><div class='output co'>#&gt; [1] 1335 1278</div><div class='input'><span class='co'>## If not otherwise specified, the settings from the xraw object are used:</span>
<span class='fu'><a href='xcmsSet-class.html'>profinfo</a></span>(<span class='no'>xraw</span>)</div><div class='output co'>#&gt; $method
#&gt; [1] "bin"
#&gt; 
#&gt; $step
#&gt; [1] 0
#&gt; </div><div class='input'><span class='co'>## To extract a profile matrix with linear interpolation use</span>
<span class='no'>profmat</span> <span class='kw'>&lt;-</span> <span class='fu'>profMat</span>(<span class='no'>xraw</span>, <span class='kw'>step</span> <span class='kw'>=</span> <span class='fl'>0.3</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"binlin"</span>)</div><div class='output co'>#&gt; <span class='message'>Create profile matrix with method 'binlin' and step 0.3 ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'><span class='co'>## Alternatively, the profMethod of the xraw objects could be changed</span>
<span class='fu'><a href='profMethod-methods.html'>profMethod</a></span>(<span class='no'>xraw</span>) <span class='kw'>&lt;-</span> <span class='st'>"binlin"</span>
<span class='no'>profmat_2</span> <span class='kw'>&lt;-</span> <span class='fu'>profMat</span>(<span class='no'>xraw</span>, <span class='kw'>step</span> <span class='kw'>=</span> <span class='fl'>0.3</span>)</div><div class='output co'>#&gt; <span class='message'>Create profile matrix with method 'binlin' and step 0.3 ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='no'>profmat</span>, <span class='no'>profmat_2</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


