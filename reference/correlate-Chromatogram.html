<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Correlate chromatograms — correlate,Chromatogram,Chromatogram-method • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Correlate chromatograms — correlate,Chromatogram,Chromatogram-method" />
<meta property="og:description" content="Correlate intensities of two chromatograms with each other. If the two
Chromatogram objects have different retention times they are first
aligned to match data points in the first to data points in the second
chromatogram. See help on alignRt in MSnbase::Chromatogram() for more
details.
If correlate is called on a single MChromatograms() object a pairwise
correlation of each chromatogram with each other is performed and a matrix
with the correlation coefficients is returned.
Note that the correlation of two chromatograms depends also on their order,
e.g. correlate(chr1, chr2) might not be identical to
correlate(chr2, chr1). The lower and upper triangular part of the
correlation matrix might thus be different.
For correlating elements of a MChromatograms with each other it might be
sufficient to calculate just the upper triangular matrix. This can be done
by setting full = FALSE." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.13.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Correlate chromatograms</h1>
    <small class="dont-index">Source: <a href='https://github.com/sneumann/xcms/blob/master/R/methods-Chromatogram.R'><code>R/methods-Chromatogram.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/methods-MChromatograms.R'><code>R/methods-MChromatograms.R</code></a></small>
    <div class="hidden name"><code>correlate-Chromatogram.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Correlate intensities of two chromatograms with each other. If the two
<code>Chromatogram</code> objects have different retention times they are first
<em>aligned</em> to match data points in the first to data points in the second
chromatogram. See help on <code>alignRt</code> in <code><a href='https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html'>MSnbase::Chromatogram()</a></code> for more
details.</p>
<p>If <code>correlate</code> is called on a single <code>MChromatograms()</code> object a pairwise
correlation of each chromatogram with each other is performed and a <code>matrix</code>
with the correlation coefficients is returned.</p>
<p>Note that the correlation of two chromatograms depends also on their order,
e.g. <code>correlate(chr1, chr2)</code> might not be identical to
<code>correlate(chr2, chr1)</code>. The lower and upper triangular part of the
correlation matrix might thus be different.</p>
<p>For correlating elements of a <code>MChromatograms</code> with each other it might be
sufficient to calculate just the upper triangular matrix. This can be done
by setting <code>full = FALSE</code>.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for Chromatogram,Chromatogram</span>
<span class='fu'>correlate</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  use <span class='op'>=</span> <span class='st'>"pairwise.complete.obs"</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pearson"</span>, <span class='st'>"kendall"</span>, <span class='st'>"spearman"</span><span class='op'>)</span>,
  align <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"closest"</span>, <span class='st'>"approx"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for MChromatograms,missing</span>
<span class='fu'>correlate</span><span class='op'>(</span>
  <span class='va'>x</span>,
  y <span class='op'>=</span> <span class='cn'>NULL</span>,
  use <span class='op'>=</span> <span class='st'>"pairwise.complete.obs"</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pearson"</span>, <span class='st'>"kendall"</span>, <span class='st'>"spearman"</span><span class='op'>)</span>,
  align <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"closest"</span>, <span class='st'>"approx"</span><span class='op'>)</span>,
  full <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for MChromatograms,MChromatograms</span>
<span class='fu'>correlate</span><span class='op'>(</span>
  <span class='va'>x</span>,
  y <span class='op'>=</span> <span class='cn'>NULL</span>,
  use <span class='op'>=</span> <span class='st'>"pairwise.complete.obs"</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pearson"</span>, <span class='st'>"kendall"</span>, <span class='st'>"spearman"</span><span class='op'>)</span>,
  align <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"closest"</span>, <span class='st'>"approx"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code>Chromatogram()</code> or <code>MChromatograms()</code> object.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p><code>Chromatogram()</code> or <code>MChromatograms()</code> object.</p></td>
    </tr>
    <tr>
      <th>use</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> passed to the <code>cor</code> function. See <code><a href='https://rdrr.io/r/stats/cor.html'>cor()</a></code> for
details.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> passed to the <code>cor</code> function. See <code><a href='https://rdrr.io/r/stats/cor.html'>cor()</a></code> for
details.</p></td>
    </tr>
    <tr>
      <th>align</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> defining the alignment method to be used. See
help on <code>alignRt</code> in <code><a href='https://lgatto.github.io/MSnbase/reference/Chromatogram-class.html'>MSnbase::Chromatogram()</a></code> for details. The value of
this parameter is passed to the <code>method</code> parameter of <code>alignRt</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>optional parameters passed along to the <code>alignRt</code> method such as
<code>tolerance</code> that, if set to <code>0</code> requires the retention times to be
identical.</p></td>
    </tr>
    <tr>
      <th>full</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> for <code>correlate</code> on a single <code>MChromatograms</code> object:
whether the <em>full</em> correlation matrix should be calculated (default) or
just the upper triangular matrix (and diagonal).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> or <code>matrix</code> (if called on <code>MChromatograms</code> objects)
with the correlation coefficient. If a <code>matrix</code> is returned, the rows
represent the chromatograms in <code>x</code> and the columns the chromatograms in
<code>y</code>.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Michael Witting, Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>chr1</span> <span class='op'>&lt;-</span> <span class='fu'>Chromatogram</span><span class='op'>(</span>rtime <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, sd <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span>,
    intensity <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>29</span>, <span class='fl'>50</span>, <span class='cn'>NA</span>, <span class='fl'>100</span>, <span class='fl'>12</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>chr2</span> <span class='op'>&lt;-</span> <span class='fu'>Chromatogram</span><span class='op'>(</span>rtime <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span>, sd <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span>,
    intensity <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>80</span>, <span class='fl'>50</span>, <span class='fl'>20</span>, <span class='fl'>10</span>, <span class='fl'>9</span>, <span class='fl'>4</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>chr3</span> <span class='op'>&lt;-</span> <span class='fu'>Chromatogram</span><span class='op'>(</span>rtime <span class='op'>=</span> <span class='fl'>3</span><span class='op'>:</span><span class='fl'>9</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>7</span>, sd <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span>,
    intensity <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>53</span>, <span class='fl'>80</span>, <span class='fl'>130</span>, <span class='fl'>15</span>, <span class='fl'>5</span>, <span class='fl'>3</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>chrs</span> <span class='op'>&lt;-</span> <span class='fu'>MChromatograms</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>chr1</span>, <span class='va'>chr2</span>, <span class='va'>chr3</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>correlate</span><span class='op'>(</span><span class='va'>chr1</span>, <span class='va'>chr2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.03928289</div><div class='input'><span class='fu'>correlate</span><span class='op'>(</span><span class='va'>chr2</span>, <span class='va'>chr1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.06267484</div><div class='input'>
<span class='co'>## To only intensities larger than 5.</span>
<span class='fu'>correlate</span><span class='op'>(</span><span class='va'>chr1</span>, <span class='va'>chr2</span>, useIntensitiesAbove <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.03928289</div><div class='input'>
<span class='fu'>correlate</span><span class='op'>(</span><span class='va'>chrs</span>, <span class='va'>chrs</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            [,1]       [,2]      [,3]
#&gt; [1,] 1.00000000 0.03928289 0.9954195
#&gt; [2,] 0.06267484 1.00000000 0.6482310
#&gt; [3,] 0.99981446 0.64823104 1.0000000</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Steffen Neumann.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9000.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


