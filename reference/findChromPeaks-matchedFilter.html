<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Peak detection in the chromatographic time domain — findChromPeaks-matchedFilter • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Peak detection in the chromatographic time domain — findChromPeaks-matchedFilter" />
<meta property="og:description" content="The matchedFilter algorithm identifies peaks in the
    chromatographic time domain as described in [Smith 2006]. The intensity
    values are binned by cutting The LC/MS data into slices (bins) of a mass
    unit (binSize m/z) wide. Within each bin the maximal intensity is
    selected. The chromatographic peak detection is then performed in each
    bin by extending it based on the steps parameter to generate
    slices comprising bins current_bin - steps +1 to
    current_bin + steps - 1. Each of these slices is then filtered
    with matched filtration using a second-derative Gaussian as the model
    peak shape. After filtration peaks are detected using a signal-to-ratio
    cut-off. For more details and illustrations see [Smith 2006].
The MatchedFilterParam class allows to specify all
    settings for a chromatographic peak detection using the matchedFilter
    method. Instances should be created with the MatchedFilterParam
    constructor.
The findChromPeaks,OnDiskMSnExp,MatchedFilterParam
    method performs peak detection using the matchedFilter algorithm
    on all samples from an OnDiskMSnExp object.
    OnDiskMSnExp objects encapsule all experiment
    specific data and load the spectra data (mz and intensity values) on the
    fly from the original files applying also all eventual data
    manipulations.
binSize,binSize&amp;lt;-: getter and setter for the
    binSize slot of the object.
impute,impute&amp;lt;-: getter and setter for the
    impute slot of the object.
baseValue,baseValue&amp;lt;-: getter and setter for the
    baseValue slot of the object.
distance,distance&amp;lt;-: getter and setter for the
    distance slot of the object.
fwhm,fwhm&amp;lt;-: getter and setter for the
    fwhm slot of the object.
sigma,sigma&amp;lt;-: getter and setter for the
    sigma slot of the object.
max,max&amp;lt;-: getter and setter for the
     max slot of the object.
snthresh,snthresh&amp;lt;-: getter and setter for the
    snthresh slot of the object.
steps,steps&amp;lt;-: getter and setter for the
    steps slot of the object.
mzdiff,mzdiff&amp;lt;-: getter and setter for the
     mzdiff slot of the object.
index,index&amp;lt;-: getter and setter for the
    index slot of the object." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/new_functionality.html">New and modified functionality in xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Peak detection in the chromatographic time domain</h1>
    <small class="dont-index">Source: <a href='https://github.com/sneumann/xcms/blob/master/R/DataClasses.R'><code>R/DataClasses.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/functions-Params.R'><code>R/functions-Params.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/methods-OnDiskMSnExp.R'><code>R/methods-OnDiskMSnExp.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>findChromPeaks-matchedFilter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <em>matchedFilter</em> algorithm identifies peaks in the
    chromatographic time domain as described in [Smith 2006]. The intensity
    values are binned by cutting The LC/MS data into slices (bins) of a mass
    unit (<code>binSize</code> m/z) wide. Within each bin the maximal intensity is
    selected. The chromatographic peak detection is then performed in each
    bin by extending it based on the <code>steps</code> parameter to generate
    slices comprising bins <code>current_bin - steps +1</code> to
    <code>current_bin + steps - 1</code>. Each of these slices is then filtered
    with matched filtration using a second-derative Gaussian as the model
    peak shape. After filtration peaks are detected using a signal-to-ratio
    cut-off. For more details and illustrations see [Smith 2006].</p>
<p>The <code>MatchedFilterParam</code> class allows to specify all
    settings for a chromatographic peak detection using the matchedFilter
    method. Instances should be created with the <code>MatchedFilterParam</code>
    constructor.</p>
<p>The <code>findChromPeaks,OnDiskMSnExp,MatchedFilterParam</code>
    method performs peak detection using the <em>matchedFilter</em> algorithm
    on all samples from an <code>OnDiskMSnExp</code> object.
    <code>OnDiskMSnExp</code> objects encapsule all experiment
    specific data and load the spectra data (mz and intensity values) on the
    fly from the original files applying also all eventual data
    manipulations.</p>
<p><code>binSize</code>,<code>binSize&lt;-</code>: getter and setter for the
    <code>binSize</code> slot of the object.</p>
<p><code>impute</code>,<code>impute&lt;-</code>: getter and setter for the
    <code>impute</code> slot of the object.</p>
<p><code>baseValue</code>,<code>baseValue&lt;-</code>: getter and setter for the
    <code>baseValue</code> slot of the object.</p>
<p><code>distance</code>,<code>distance&lt;-</code>: getter and setter for the
    <code>distance</code> slot of the object.</p>
<p><code>fwhm</code>,<code>fwhm&lt;-</code>: getter and setter for the
    <code>fwhm</code> slot of the object.</p>
<p><code>sigma</code>,<code>sigma&lt;-</code>: getter and setter for the
    <code>sigma</code> slot of the object.</p>
<p><code>max</code>,<code>max&lt;-</code>: getter and setter for the
     <code>max</code> slot of the object.</p>
<p><code>snthresh</code>,<code>snthresh&lt;-</code>: getter and setter for the
    <code>snthresh</code> slot of the object.</p>
<p><code>steps</code>,<code>steps&lt;-</code>: getter and setter for the
    <code>steps</code> slot of the object.</p>
<p><code>mzdiff</code>,<code>mzdiff&lt;-</code>: getter and setter for the
     <code>mzdiff</code> slot of the object.</p>
<p><code>index</code>,<code>index&lt;-</code>: getter and setter for the
    <code>index</code> slot of the object.</p>
    </div>

    <pre class="usage"><span class='fu'>MatchedFilterParam</span>(
  <span class='kw'>binSize</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>impute</span> <span class='kw'>=</span> <span class='st'>"none"</span>,
  <span class='kw'>baseValue</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  <span class='kw'>distance</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  <span class='kw'>fwhm</span> <span class='kw'>=</span> <span class='fl'>30</span>,
  <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='no'>fwhm</span>/<span class='fl'>2.3548</span>,
  <span class='kw'>max</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>snthresh</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>steps</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>mzdiff</span> <span class='kw'>=</span> <span class='fl'>0.8</span> - <span class='no'>binSize</span> * <span class='no'>steps</span>,
  <span class='kw'>index</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)

<span class='co'># S4 method for OnDiskMSnExp,MatchedFilterParam</span>
<span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span>(
  <span class='no'>object</span>,
  <span class='no'>param</span>,
  <span class='kw'>BPPARAM</span> <span class='kw'>=</span> <span class='fu'>bpparam</span>(),
  <span class='kw'>return.type</span> <span class='kw'>=</span> <span class='st'>"XCMSnExp"</span>,
  <span class='kw'>msLevel</span> <span class='kw'>=</span> <span class='fl'>1L</span>
)

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>show</span>(<span class='no'>object</span>)

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>binSize</span>(<span class='no'>object</span>)

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>binSize</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>impute</span>(<span class='no'>object</span>)

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>impute</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>baseValue</span>(<span class='no'>object</span>)

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>baseValue</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>distance</span>(<span class='no'>object</span>)

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>distance</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>fwhm</span>(<span class='no'>object</span>)

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>fwhm</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>sigma</span>(<span class='no'>object</span>)

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>sigma</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='no'>x</span>)

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>snthresh</a></span>(<span class='no'>object</span>)

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>snthresh</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>steps</span>(<span class='no'>object</span>)

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>steps</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>mzdiff</a></span>(<span class='no'>object</span>)

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>mzdiff</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>index</span>(<span class='no'>object</span>)

<span class='co'># S4 method for MatchedFilterParam</span>
<span class='fu'>index</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>binSize</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> specifying the width of the
bins/slices in m/z dimension.</p></td>
    </tr>
    <tr>
      <th>impute</th>
      <td><p>Character string specifying the method to be used for missing
value imputation. Allowed values are <code>"none"</code> (no linear
interpolation), <code>"lin"</code> (linear interpolation), <code>"linbase"</code>
(linear interpolation within a certain bin-neighborhood) and
<code>"intlin"</code>. See <code><a href='imputeLinInterpol.html'>imputeLinInterpol</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>baseValue</th>
      <td><p>The base value to which empty elements should be set. This
is only considered for <code>method = "linbase"</code> and corresponds to the
<code>profBinLinBase</code>'s <code>baselevel</code> argument.</p></td>
    </tr>
    <tr>
      <th>distance</th>
      <td><p>For <code>method = "linbase"</code>: number of non-empty
neighboring element of an empty element that should be considered for
linear interpolation. See details section for more information.</p></td>
    </tr>
    <tr>
      <th>fwhm</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> specifying the full width at half maximum
of matched filtration gaussian model peak. Only used to calculate the
actual sigma, see below.</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> specifying the standard deviation (width)
of the matched filtration model peak.</p></td>
    </tr>
    <tr>
      <th>max</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> representing the maximum number of peaks
that are expected/will be identified per slice.</p></td>
    </tr>
    <tr>
      <th>snthresh</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the signal to noise cutoff
to be used in the chromatographic peak detection step.</p></td>
    </tr>
    <tr>
      <th>steps</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the number of bins to be
merged before filtration (i.e. the number of neighboring bins that will
be joined to the slice in which filtration and peak detection will be
performed).</p></td>
    </tr>
    <tr>
      <th>mzdiff</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the minimum difference
in m/z for peaks with overlapping retention times</p></td>
    </tr>
    <tr>
      <th>index</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> specifying whether indicies should be
returned instead of values for m/z and retention times.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>For <code>findChromPeaks</code>: an
    <code>OnDiskMSnExp</code> object containing the MS- and all
    other experiment-relevant data.</p>
<p>For all other methods: a parameter object.</p></td>
    </tr>
    <tr>
      <th>param</th>
      <td><p>An <code>MatchedFilterParam</code> object containing all settings for
the matchedFilter algorithm.</p></td>
    </tr>
    <tr>
      <th>BPPARAM</th>
      <td><p>A parameter class specifying if and how parallel processing
should be performed. It defaults to <code>bpparam</code>.
See documentation of the <code>BiocParallel</code> for more details. If
parallel processing is enabled, peak detection is performed in parallel
on several of the input samples.</p></td>
    </tr>
    <tr>
      <th>return.type</th>
      <td><p>Character specifying what type of object the method should
return. Can be either <code>"XCMSnExp"</code> (default), <code>"list"</code> or
<code>"xcmsSet"</code>.</p></td>
    </tr>
    <tr>
      <th>msLevel</th>
      <td><p><code><a href='https://rdrr.io/r/base/integer.html'>integer(1)</a></code> defining the MS level on which the peak
detection should be performed. Defaults to <code>msLevel = 1</code>.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>The value for the slot.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>For <code>max</code>: a <code>MatchedFilterParam</code> object.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The <code>MatchedFilterParam</code> function returns a
    <code>MatchedFilterParam</code> class instance with all of the settings
    specified for chromatographic detection by the <em>matchedFilter</em>
    method.</p>
<p>For <code>findChromPeaks</code>: if <code>return.type = "XCMSnExp"</code> an
    <code><a href='XCMSnExp-class.html'>XCMSnExp</a></code> object with the results of the peak detection.
    If <code>return.type = "list"</code> a list of length equal to the number of
    samples with matrices specifying the identified peaks.
    If <code>return.type = "xcmsSet"</code> an <code><a href='xcmsSet-class.html'>xcmsSet</a></code> object
    with the results of the peak detection.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The intensities are binned by the provided m/z values within each
    spectrum (scan). Binning is performed such that the bins are centered
    around the m/z values (i.e. the first bin includes all m/z values between
    <code>min(mz) - bin_size/2</code> and <code>min(mz) + bin_size/2</code>).</p>
<p>For more details on binning and missing value imputation see
    <code><a href='binYonX.html'>binYonX</a></code> and <code><a href='imputeLinInterpol.html'>imputeLinInterpol</a></code> methods.</p>
<p>Parallel processing (one process per sample) is supported and can
    be configured either by the <code>BPPARAM</code> parameter or by globally
    defining the parallel processing mode using the
    <code>register</code> method from the <code>BiocParallel</code>
    package.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl>
<dt><code>.__classVersion__,binSize,impute,baseValue,distance,fwhm,sigma,max,snthresh,steps,mzdiff,index</code></dt><dd><p>See corresponding parameter above. <code>.__classVersion__</code> stores
the version from the class. Slots values should exclusively be accessed
<em>via</em> the corresponding getter and setter methods listed above.</p></dd>

</dl>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>These methods and classes are part of the updated and modernized
    <code>xcms</code> user interface which will eventually replace the
    <code><a href='findPeaks-methods.html'>findPeaks</a></code> methods. It supports chromatographic peak
    detection on
    <code><a href='https://rdrr.io/pkg/MSnbase/man/OnDiskMSnExp-class.html'>OnDiskMSnExp</a></code> objects (defined in the
    <code>MSnbase</code> package). All of the settings to the matchedFilter
    algorithm can be passed with a <code>MatchedFilterParam</code> object.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Colin A. Smith, Elizabeth J. Want, Grace O'Maille, Ruben Abagyan and
Gary Siuzdak. "XCMS: Processing Mass Spectrometry Data for Metabolite
Profiling Using Nonlinear Peak Alignment, Matching, and Identification"
<em>Anal. Chem.</em> 2006, 78:779-787.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The <code><a href='do_findChromPeaks_matchedFilter.html'>do_findChromPeaks_matchedFilter</a></code> core API function
and <code><a href='findPeaks.matchedFilter-xcmsRaw-method.html'>findPeaks.matchedFilter</a></code> for the old user interface.</p>
<p><code><a href='peaksWithMatchedFilter.html'>peaksWithMatchedFilter</a></code> for functions to perform matchedFilter
peak detection in purely chromatographic data.</p>
<p><code><a href='XCMSnExp-class.html'>XCMSnExp</a></code> for the object containing the results of
    the chromatographic peak detection.</p>
<p>Other peak detection methods: 
<code><a href='chromatographic-peak-detection.html'>chromatographic-peak-detection</a></code>,
<code><a href='findChromPeaks-centWaveWithPredIsoROIs.html'>findChromPeaks-centWaveWithPredIsoROIs</a></code>,
<code><a href='findChromPeaks-centWave.html'>findChromPeaks-centWave</a></code>,
<code><a href='findChromPeaks-massifquant.html'>findChromPeaks-massifquant</a></code>,
<code><a href='findPeaks-MSW.html'>findPeaks-MSW</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Create a MatchedFilterParam object. Note that we use a unnecessarily large</span>
<span class='co'>## binSize parameter to reduce the run-time of the example.</span>
<span class='no'>mfp</span> <span class='kw'>&lt;-</span> <span class='fu'>MatchedFilterParam</span>(<span class='kw'>binSize</span> <span class='kw'>=</span> <span class='fl'>5</span>)
<span class='co'>## Change snthresh parameter</span>
<span class='fu'><a href='findChromPeaks-centWave.html'>snthresh</a></span>(<span class='no'>mfp</span>) <span class='kw'>&lt;-</span> <span class='fl'>15</span>
<span class='no'>mfp</span></div><div class='output co'>#&gt; Object of class:  MatchedFilterParam 
#&gt; Parameters:
#&gt;  binSize: 5 
#&gt;  impute: none 
#&gt;  baseValue:  
#&gt;  distance:  
#&gt;  fwhm: 30 
#&gt;  sigma: 12.73994 
#&gt;  max: 5 
#&gt;  snthresh: 15 
#&gt;  steps: 2 
#&gt;  mzdiff: -9.2 
#&gt;  index: FALSE </div><div class='input'>
<span class='co'>## Perform the peak detection using matchecFilter on the files from the</span>
<span class='co'>## faahKO package. Files are read using the readMSData from the MSnbase</span>
<span class='co'>## package</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>faahKO</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>MSnbase</span>)
<span class='no'>fls</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>dir</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"cdf/KO"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"faahKO"</span>), <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
           <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>raw_data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MSnbase/man/readMSData.html'>readMSData</a></span>(<span class='no'>fls</span>[<span class='fl'>1</span>:<span class='fl'>2</span>], <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"onDisk"</span>)</div><div class='output co'>#&gt; <span class='message'>Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span></div><div class='input'><span class='co'>## Perform the chromatographic peak detection using the settings defined</span>
<span class='co'>## above. Note that we are also disabling parallel processing in this</span>
<span class='co'>## example by registering a "SerialParam"</span>
<span class='fu'>register</span>(<span class='fu'>SerialParam</span>())
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span>(<span class='no'>raw_data</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='no'>mfp</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='XCMSnExp-class.html'>chromPeaks</a></span>(<span class='no'>res</span>))</div><div class='output co'>#&gt;             mz mzmin mzmax       rt    rtmin    rtmax      into    intf  maxo
#&gt; CP001 205.0000 205.0 205.0 2784.635 2770.550 2800.284 1778568.9 3580020 84280
#&gt; CP002 205.0000 205.0 205.0 2784.635 2770.550 2800.284 1778568.9 3577971 84280
#&gt; CP003 241.1460 241.1 241.2 3662.574 3646.924 3682.918 1465988.7 2234510 49728
#&gt; CP004 241.1460 241.1 241.2 3662.574 3646.924 3682.918 1465988.7 2234510 49728
#&gt; CP005 244.1000 244.1 244.1 2828.453 2814.369 2842.538  598990.3 1145078 31312
#&gt; CP006 249.1591 249.1 249.2 3659.444 3643.794 3678.223 1435000.7 2367467 49040
#&gt;            maxf i       sn sample
#&gt; CP001 194233.12 1 63.28090      1
#&gt; CP002 194213.46 1 66.00099      1
#&gt; CP003  96022.23 1 25.42409      1
#&gt; CP004  96022.23 1 25.42643      1
#&gt; CP005  64181.64 2 16.99513      1
#&gt; CP006 104291.09 1 36.83500      1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


