<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Feature detection for high resolution LC/MS data — findPeaks.centWave-methods • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Feature detection for high resolution LC/MS data — findPeaks.centWave-methods" />
<meta property="og:description" content="Peak density and wavelet based feature detection for high resolution LC/MS data in centroid mode" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/new_functionality.html">New and modified functionality in xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Feature detection for high resolution LC/MS data</h1>
    
    <div class="hidden name"><code>findPeaks.centWave-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Peak density and wavelet based feature detection for high resolution LC/MS data in centroid mode</p>
    </div>


    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p><code>xcmsSet</code> object</p></td>
    </tr>
    <tr>
      <th>ppm</th>
      <td><p>maxmial tolerated m/z deviation in consecutive scans, in ppm (parts per million)</p></td>
    </tr>
    <tr>
      <th>peakwidth</th>
      <td><p>Chromatographic peak width, given as range (min,max) in seconds</p></td>
    </tr>
    <tr>
      <th>snthresh</th>
      <td><p>signal to noise ratio cutoff, definition see below.</p></td>
    </tr>
    <tr>
      <th>prefilter</th>
      <td><p><code>prefilter=c(k,I)</code>. Prefilter step for the first phase. Mass traces are only retained if they contain at least <code>k</code> peaks with intensity &gt;= <code>I</code>.</p></td>
    </tr>
    <tr>
      <th>mzCenterFun</th>
      <td><p>Function to calculate the m/z center of the feature: <code>wMean</code> intensity weighted mean of the feature m/z values, <code>mean</code> mean of the feature m/z values, <code>apex</code> use m/z value at peak apex,
        <code>wMeanApex3</code> intensity weighted mean of the m/z value at peak apex and the m/z value left and right of it, <code>meanApex3</code> mean of the m/z value at peak apex and the m/z value left and right of it.</p></td>
    </tr>
    <tr>
      <th>integrate</th>
      <td><p>Integration method. If <code>=1</code> peak limits are found through descent on the mexican hat filtered data, if <code>=2</code> the descent is done on the real data. Method 2 is very accurate but prone to noise, while method 1 is more robust to noise but less exact.</p></td>
    </tr>
    <tr>
      <th>mzdiff</th>
      <td><p>minimum difference in m/z for peaks with overlapping retention
    times, can be negative to allow overlap</p></td>
    </tr>
    <tr>
      <th>fitgauss</th>
      <td><p>logical, if TRUE a Gaussian is fitted to each peak</p></td>
    </tr>
    <tr>
      <th>scanrange</th>
      <td><p>scan range to process</p></td>
    </tr>
    <tr>
      <th>noise</th>
      <td><p>optional argument which is useful for data that was centroided without any intensity threshold,
    centroids with intensity &lt; <code>noise</code> are omitted from ROI detection</p></td>
    </tr>
    <tr>
      <th>sleep</th>
      <td><p>number of seconds to pause between plotting peak finding cycles</p></td>
    </tr>
    <tr>
      <th>verbose.columns</th>
      <td><p>logical, if TRUE additional peak meta data columns are returned</p></td>
    </tr>
    <tr>
      <th>ROI.list</th>
      <td><p>A optional list of ROIs that represents detected mass traces (ROIs).  If this list is empty (default) then centWave detects the mass trace ROIs,
    otherwise this step is skipped and the supplied ROIs are used in the peak detection phase.  Each ROI object in the list has the following slots:
    <code>scmin</code> start scan index,
    <code>scmax</code> end scan index,
    <code>mzmin</code> minimum m/z,
    <code>mzmax</code> maximum m/z,
    <code>length</code> number of scans,
    <code>intensity</code> summed intensity.</p></td>
    </tr>
    <tr>
      <th>firstBaselineCheck</th>
      <td><p>logical, if TRUE continuous data within ROI is checked to be above 1st baseline</p></td>
    </tr>
    <tr>
      <th>roiScales</th>
      <td><p>numeric, optional vector of scales for each ROI in <code>ROI.list</code> to be used for the centWave-wavelets</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
<dl>
<dt>object = "xcmsRaw"</dt><dd><p><code>
    findPeaks.centWave(object, ppm=25, peakwidth=c(20,50), snthresh=10,
    prefilter=c(3,100), mzCenterFun="wMean", integrate=1, mzdiff=-0.001, fitgauss=FALSE,
    scanrange= numeric(), noise=0, sleep=0, verbose.columns=FALSE, ROI.list=list()),
    firstBaselineCheck=TRUE, roiScales=NULL
  </code></p></dd>

</dl>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This algorithm is most suitable for high resolution LC/{TOF,OrbiTrap,FTICR}-MS data in centroid mode. In the first phase of the method mass traces (characterised as regions with less than <code>ppm</code> m/z deviation in consecutive scans) in the LC/MS map are located.
  In the second phase these mass traces are further analysed.
  Continuous wavelet transform (CWT) is used to locate chromatographic peaks on different scales.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A matrix with columns:</p>
<p></p>
<dt>mz</dt><dd><p>weighted (by intensity) mean of peak m/z across scans</p></dd>
  <dt>mzmin</dt><dd><p>m/z peak minimum</p></dd>
  <dt>mzmax</dt><dd><p>m/z peak maximum</p></dd>
  <dt>rt</dt><dd><p>retention time of peak midpoint</p></dd>
  <dt>rtmin</dt><dd><p>leading edge of peak retention time</p></dd>
  <dt>rtmax</dt><dd><p>trailing edge of peak retention time</p></dd>
  <dt>into</dt><dd><p>integrated peak intensity</p></dd>
   <dt>intb</dt><dd><p>baseline corrected integrated peak intensity</p></dd>
  <dt>maxo</dt><dd><p>maximum peak intensity</p></dd>
  <dt>sn</dt><dd><p>Signal/Noise ratio, defined as <code>(maxo - baseline)/sd</code>, where <br />
    <code>maxo</code> is the maximum peak intensity, <br />
    <code>baseline</code> the estimated baseline value and <br />
    <code>sd</code> the standard deviation of local chromatographic noise.</p></dd>
  <dt>egauss</dt><dd><p>RMSE of Gaussian fit</p></dd>
  <dt></dt><dd><p>if <code>verbose.columns</code> is <code>TRUE</code> additionally :</p></dd>
  <dt>mu</dt><dd><p>Gaussian parameter mu</p></dd>
  <dt>sigma</dt><dd><p>Gaussian parameter sigma</p></dd>
  <dt>h</dt><dd><p>Gaussian parameter h</p></dd>
  <dt>f</dt><dd><p>Region number of m/z ROI where the peak was localised</p></dd>
  <dt>dppm</dt><dd><p>m/z deviation of mass trace across scans in ppm</p></dd>
  <dt>scale</dt><dd><p>Scale on which the peak was localised</p></dd>
  <dt>scpos</dt><dd><p>Peak position found by wavelet analysis</p></dd>
  <dt>scmin</dt><dd><p>Left peak limit found by wavelet analysis (scan number)</p></dd>
  <dt>scmax</dt><dd><p>Right peak limit found by wavelet analysis (scan number)</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ralf Tautenhahn, Christoph B\"ottcher, and Steffen Neumann
  "Highly sensitive feature detection for high resolution LC/MS"
  BMC Bioinformatics 2008, 9:504</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='findChromPeaks-centWave.html'>centWave</a></code> for the new user interface.
  <code><a href='findPeaks-methods.html'>findPeaks-methods</a></code>
  <code><a href='xcmsRaw-class.html'>xcmsRaw-class</a></code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


