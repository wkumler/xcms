<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Data container storing xcms preprocessing results — XCMSnExp-class • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Data container storing xcms preprocessing results — XCMSnExp-class" />
<meta property="og:description" content="The XCMSnExp object is a container for the results of a G/LC-MS
data preprocessing that comprises chromatographic peak detection, alignment
and correspondence. These results can be accessed with the chromPeaks,
adjustedRtime and featureDefinitions functions; see below
(after the Usage, Arguments, Value and Slots sections) for more details).
Along with the results, the object contains the processing history that
allows to track each processing step along with the used settings. This
can be extracted with the processHistory method.
XCMSnExp objects, by directly extending the
OnDiskMSnExp object from the MSnbase package, inherit
all of its functionality and allows thus an easy access to the full raw
data at any stage of an analysis.
To support interaction with packages requiring the old objects,
XCMSnExp objects can be coerced into xcmsSet
objects using the as method (see examples below). All
preprocessing results will be passed along to the resulting
xcmsSet object.
General functions for XCMSnExp objects are (see further below for
specific function to handle chromatographic peak data, alignment and
correspondence results):
processHistoryTypes returns the available types of
    process histories. These can be passed with argument type to the
    processHistory method to extract specific process step(s).
hasFilledChromPeaks: whether filled-in peaks are present or not.
profMat: creates a profile matrix, which
    is a n x m matrix, n (rows) representing equally spaced m/z values (bins)
    and m (columns) the retention time of the corresponding scans. Each cell
    contains the maximum intensity measured for the specific scan and m/z
    values. See profMat for more details and description of
    the various binning methods.
hasAdjustedRtime: whether the object provides adjusted
retention times.
hasFeatures: whether the object contains correspondence
results (i.e. features).
hasChromPeaks: whether the object contains peak
detection results.
hasFilledChromPeaks: whether the object contains any filled-in
chromatographic peaks.
adjustedRtime,adjustedRtime&amp;lt;-:
extract/set adjusted retention times. adjustedRtime&amp;lt;- should not
be called manually, it is called internally by the
adjustRtime methods. For XCMSnExp objects,
adjustedRtime&amp;lt;- does also apply retention time adjustments to
eventually present chromatographic peaks. The bySample parameter
allows to specify whether the adjusted retention time should be grouped
by sample (file).
featureDefinitions, featureDefinitions&amp;lt;-: extract
or set the correspondence results, i.e. the mz-rt features (peak groups).
Similar to the chromPeaks it is possible to extract features for
specified m/z and/or rt ranges. The function supports also the parameter
type that allows to specify which features to be returned if any
of rt or mz is specified. For details see help of
chromPeaks.
See also featureSummary for a function to calculate simple
feature summaries.
chromPeaks, chromPeaks&amp;lt;-: extract or set
the matrix containing the information on identified chromatographic
peaks. Rownames of the matrix represent unique IDs of the respective peaks
within the experiment.
Parameter bySample allows to specify whether peaks should
be returned ungrouped (default bySample = FALSE) or grouped by
sample (bySample = TRUE). The chromPeaks&amp;lt;- method for
XCMSnExp objects removes also all correspondence (peak grouping)
and retention time correction (alignment) results. The optional
arguments rt, mz, ppm and type allow to extract
only chromatographic peaks overlapping the defined retention time and/or
m/z ranges. Argument type allows to define how overlapping is
determined: for type == &quot;any&quot; (the default), all peaks that are even
partially overlapping the region are returned, for type == &quot;within&quot;
the full peak has to be within the region and for
type == &quot;apex_within&quot; the peak's apex position (highest signal of the
peak) has to be within the region.
See description of the return value for details on the returned matrix.
Users usually don't have to use the chromPeaks&amp;lt;- method directly
as detected chromatographic peaks are added to the object by the
findChromPeaks method. Also, chromPeaks&amp;lt;- will replace
any existing chromPeakData.
chromPeakData and chromPeakData&amp;lt;- allow to get or set arbitrary
chromatographic peak annotations. These are returned or ar returned as a
DataFrame. Note that the number of rows and the rownames of the
DataFrame have to match those of chromPeaks.
rtime: extracts the retention time for each
scan. The bySample parameter allows to return the values grouped
by sample/file and adjusted whether adjusted or raw retention
times should be returned. By default the method returns adjusted
retention times, if they are available (i.e. if retention times were
adjusted using the adjustRtime method).
mz: extracts the mz values from each scan of
all files within an XCMSnExp object. These values are extracted
from the original data files and eventual processing steps are applied
on the fly. Using the bySample parameter it is possible to
switch from the default grouping of mz values by spectrum/scan to a
grouping by sample/file.
intensity: extracts the intensity values from
each scan of all files within an XCMSnExp object. These values are
extracted from the original data files and eventual processing steps are
applied on the fly. Using the bySample parameter it is
possible to switch from the default grouping of intensity values by
spectrum/scan to a grouping by sample/file.
spectra: extracts the
Spectrum objects containing all data from
object. The values are extracted from the original data files and
eventual processing steps are applied on the fly. By setting
bySample = TRUE, the spectra are returned grouped by sample/file.
If the XCMSnExp object contains adjusted retention times, these
are returned by default in the Spectrum objects (can be
overwritten by setting adjusted = FALSE).
processHistory: returns a list of
ProcessHistory objects (or objects inheriting from this
base class) representing the individual processing steps that have been
performed, eventually along with their settings (Param parameter
class). Optional arguments fileIndex, type and
msLevel allow to restrict to process steps of a certain type or
performed on a certain file or MS level.
dropChromPeaks: drops any identified chromatographic
peaks and returns the object without that information. Note that for
XCMSnExp objects the method drops by default also results from a
correspondence (peak grouping) analysis. Adjusted retention times are
removed if the alignment has been performed after peak detection.
This can be overruled with keepAdjustedRtime = TRUE.
dropFeatureDefinitions: drops the results from a
correspondence (peak grouping) analysis, i.e. the definition of the mz-rt
features and returns the object without that information. Note that for
XCMSnExp objects the method will also by default drop retention
time adjustment results, if these were performed after the last peak
grouping (i.e. which base on the results from the peak grouping that are
going to be removed). All related process history steps are
removed too as well as eventually filled in peaks
(by fillChromPeaks). The parameter keepAdjustedRtime
can be used to avoid removal of adjusted retention times.
dropAdjustedRtime: drops any retention time
adjustment information and returns the object without adjusted retention
time. For XCMSnExp objects, this also reverts the retention times
reported for the chromatographic peaks in the peak matrix to the
original, raw, ones (after chromatographic peak detection). Note that
for XCMSnExp objects the method drops also all peak grouping
results if these were performed after the retention time
adjustment. All related process history steps are removed too.
findChromPeaks performs chromatographic peak detection
on the provided XCMSnExp objects. For more details see the method
for XCMSnExp.
Note that by default (with parameter add = FALSE) previous peak
detection results are removed. Use add = TRUE to perform a second
round of peak detection and add the newly identified peaks to the previous
peak detection results. Correspondence results (features) are always removed
prior to peak detection. Previous alignment (retention
time adjustment) results are kept, i.e. chromatographic peak detection
is performed using adjusted retention times if the data was first
aligned using e.g. obiwarp (adjustRtime-obiwarp).
dropFilledChromPeaks: drops any filled-in chromatographic
peaks (filled in by the fillChromPeaks method) and all
related process history steps.
spectrapply applies the provided function to each
Spectrum in the object and returns its
results. If no function is specified the function simply returns the
list of Spectrum objects.
XCMSnExp objects can be combined with the c function. This
combines identified chromatographic peaks and the objects' pheno data but
discards alignment results or feature definitions.
plot plots the spectrum data (see plot for
MSnExp objects in the MSnbase package for more details.
For type = &quot;XIC&quot;, identified chromatographic peaks will be indicated
as rectangles with border color peakCol." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/new_functionality.html">New and modified functionality in xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Data container storing xcms preprocessing results</h1>
    <small class="dont-index">Source: <a href='https://github.com/sneumann/xcms/blob/master/R/DataClasses.R'><code>R/DataClasses.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/functions-ProcessHistory.R'><code>R/functions-ProcessHistory.R</code></a>, <a href='https://github.com/sneumann/xcms/blob/master/R/functions-XCMSnExp.R'><code>R/functions-XCMSnExp.R</code></a>, and 2 more</small>
    <div class="hidden name"><code>XCMSnExp-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>XCMSnExp</code> object is a container for the results of a G/LC-MS
data preprocessing that comprises chromatographic peak detection, alignment
and correspondence. These results can be accessed with the <code>chromPeaks</code>,
<code>adjustedRtime</code> and <code>featureDefinitions</code> functions; see below
(after the Usage, Arguments, Value and Slots sections) for more details).
Along with the results, the object contains the processing history that
allows to track each processing step along with the used settings. This
can be extracted with the <code>processHistory</code> method.
<code>XCMSnExp</code> objects, by directly extending the
<code>OnDiskMSnExp</code> object from the <code>MSnbase</code> package, inherit
all of its functionality and allows thus an easy access to the full raw
data at any stage of an analysis.
To support interaction with packages requiring the <em>old</em> objects,
<code>XCMSnExp</code> objects can be coerced into <code><a href='xcmsSet-class.html'>xcmsSet</a></code>
objects using the <code>as</code> method (see examples below). All
preprocessing results will be passed along to the resulting
<code>xcmsSet</code> object.</p>
<p>General functions for <code>XCMSnExp</code> objects are (see further below for
specific function to handle chromatographic peak data, alignment and
correspondence results):</p>
<p><code>processHistoryTypes</code> returns the available <em>types</em> of
    process histories. These can be passed with argument <code>type</code> to the
    <code>processHistory</code> method to extract specific process step(s).</p>
<p><code>hasFilledChromPeaks</code>: whether filled-in peaks are present or not.</p>
<p><code>profMat</code>: creates a <em>profile matrix</em>, which
    is a n x m matrix, n (rows) representing equally spaced m/z values (bins)
    and m (columns) the retention time of the corresponding scans. Each cell
    contains the maximum intensity measured for the specific scan and m/z
    values. See <code><a href='profMat-xcmsSet.html'>profMat</a></code> for more details and description of
    the various binning methods.</p>
<p><code>hasAdjustedRtime</code>: whether the object provides adjusted
retention times.</p>
<p><code>hasFeatures</code>: whether the object contains correspondence
results (i.e. features).</p>
<p><code>hasChromPeaks</code>: whether the object contains peak
detection results.</p>
<p><code>hasFilledChromPeaks</code>: whether the object contains any filled-in
chromatographic peaks.</p>
<p><code>adjustedRtime</code>,<code>adjustedRtime&lt;-</code>:
extract/set adjusted retention times. <code>adjustedRtime&lt;-</code> should not
be called manually, it is called internally by the
<code><a href='adjustRtime.html'>adjustRtime</a></code> methods. For <code>XCMSnExp</code> objects,
<code>adjustedRtime&lt;-</code> does also apply retention time adjustments to
eventually present chromatographic peaks. The <code>bySample</code> parameter
allows to specify whether the adjusted retention time should be grouped
by sample (file).</p>
<p><code>featureDefinitions</code>, <code>featureDefinitions&lt;-</code>: extract
or set the correspondence results, i.e. the mz-rt features (peak groups).
Similar to the <code>chromPeaks</code> it is possible to extract features for
specified m/z and/or rt ranges. The function supports also the parameter
<code>type</code> that allows to specify which features to be returned if any
of <code>rt</code> or <code>mz</code> is specified. For details see help of
<code>chromPeaks</code>.
See also <code><a href='featureSummary.html'>featureSummary</a></code> for a function to calculate simple
feature summaries.</p>
<p><code>chromPeaks</code>, <code>chromPeaks&lt;-</code>: extract or set
the matrix containing the information on identified chromatographic
peaks. Rownames of the matrix represent unique IDs of the respective peaks
within the experiment.
Parameter <code>bySample</code> allows to specify whether peaks should
be returned ungrouped (default <code>bySample = FALSE</code>) or grouped by
sample (<code>bySample = TRUE</code>). The <code>chromPeaks&lt;-</code> method for
<code>XCMSnExp</code> objects removes also all correspondence (peak grouping)
and retention time correction (alignment) results. The optional
arguments <code>rt</code>, <code>mz</code>, <code>ppm</code> and <code>type</code> allow to extract
only chromatographic peaks overlapping the defined retention time and/or
m/z ranges. Argument <code>type</code> allows to define how <em>overlapping</em> is
determined: for <code>type == "any"</code> (the default), all peaks that are even
partially overlapping the region are returned, for <code>type == "within"</code>
the full peak has to be within the region and for
<code>type == "apex_within"</code> the peak's apex position (highest signal of the
peak) has to be within the region.
See description of the return value for details on the returned matrix.
Users usually don't have to use the <code>chromPeaks&lt;-</code> method directly
as detected chromatographic peaks are added to the object by the
<code><a href='chromatographic-peak-detection.html'>findChromPeaks</a></code> method. Also, <code>chromPeaks&lt;-</code> will replace
any existing <code>chromPeakData</code>.</p>
<p><code>chromPeakData</code> and <code>chromPeakData&lt;-</code> allow to get or set arbitrary
chromatographic peak annotations. These are returned or ar returned as a
<code>DataFrame</code>. Note that the number of rows and the rownames of the
<code>DataFrame</code> have to match those of <code>chromPeaks</code>.</p>
<p><code>rtime</code>: extracts the retention time for each
scan. The <code>bySample</code> parameter allows to return the values grouped
by sample/file and <code>adjusted</code> whether adjusted or raw retention
times should be returned. By default the method returns adjusted
retention times, if they are available (i.e. if retention times were
adjusted using the <code><a href='adjustRtime.html'>adjustRtime</a></code> method).</p>
<p><code>mz</code>: extracts the mz values from each scan of
all files within an <code>XCMSnExp</code> object. These values are extracted
from the original data files and eventual processing steps are applied
<em>on the fly</em>. Using the <code>bySample</code> parameter it is possible to
switch from the default grouping of mz values by spectrum/scan to a
grouping by sample/file.</p>
<p><code>intensity</code>: extracts the intensity values from
each scan of all files within an <code>XCMSnExp</code> object. These values are
extracted from the original data files and eventual processing steps are
applied <em>on the fly</em>. Using the <code>bySample</code> parameter it is
possible to switch from the default grouping of intensity values by
spectrum/scan to a grouping by sample/file.</p>
<p><code>spectra</code>: extracts the
<code>Spectrum</code> objects containing all data from
<code>object</code>. The values are extracted from the original data files and
eventual processing steps are applied <em>on the fly</em>. By setting
<code>bySample = TRUE</code>, the spectra are returned grouped by sample/file.
If the <code>XCMSnExp</code> object contains adjusted retention times, these
are returned by default in the <code>Spectrum</code> objects (can be
overwritten by setting <code>adjusted = FALSE</code>).</p>
<p><code>processHistory</code>: returns a <code>list</code> of
<code><a href='ProcessHistory-class.html'>ProcessHistory</a></code> objects (or objects inheriting from this
base class) representing the individual processing steps that have been
performed, eventually along with their settings (<code>Param</code> parameter
class). Optional arguments <code>fileIndex</code>, <code>type</code> and
<code>msLevel</code> allow to restrict to process steps of a certain type or
performed on a certain file or MS level.</p>
<p><code>dropChromPeaks</code>: drops any identified chromatographic
peaks and returns the object without that information. Note that for
<code>XCMSnExp</code> objects the method drops by default also results from a
correspondence (peak grouping) analysis. Adjusted retention times are
removed if the alignment has been performed <em>after</em> peak detection.
This can be overruled with <code>keepAdjustedRtime = TRUE</code>.</p>
<p><code>dropFeatureDefinitions</code>: drops the results from a
correspondence (peak grouping) analysis, i.e. the definition of the mz-rt
features and returns the object without that information. Note that for
<code>XCMSnExp</code> objects the method will also by default drop retention
time adjustment results, if these were performed after the last peak
grouping (i.e. which base on the results from the peak grouping that are
going to be removed). All related process history steps are
removed too as well as eventually filled in peaks
(by <code><a href='fillChromPeaks.html'>fillChromPeaks</a></code>). The parameter <code>keepAdjustedRtime</code>
can be used to avoid removal of adjusted retention times.</p>
<p><code>dropAdjustedRtime</code>: drops any retention time
adjustment information and returns the object without adjusted retention
time. For <code>XCMSnExp</code> objects, this also reverts the retention times
reported for the chromatographic peaks in the peak matrix to the
original, raw, ones (after chromatographic peak detection). Note that
for <code>XCMSnExp</code> objects the method drops also all peak grouping
results if these were performed <em>after</em> the retention time
adjustment. All related process history steps are removed too.</p>
<p><code>findChromPeaks</code> performs chromatographic peak detection
on the provided <code>XCMSnExp</code> objects. For more details see the method
for <code>XCMSnExp</code>.
Note that by default (with parameter <code>add = FALSE</code>) previous peak
detection results are removed. Use <code>add = TRUE</code> to perform a second
round of peak detection and add the newly identified peaks to the previous
peak detection results. Correspondence results (features) are always removed
prior to peak detection. Previous alignment (retention
time adjustment) results are kept, i.e. chromatographic peak detection
is performed using adjusted retention times if the data was first
aligned using e.g. obiwarp (<code><a href='adjustRtime-obiwarp.html'>adjustRtime-obiwarp</a></code>).</p>
<p><code>dropFilledChromPeaks</code>: drops any filled-in chromatographic
peaks (filled in by the <code><a href='fillChromPeaks.html'>fillChromPeaks</a></code> method) and all
related process history steps.</p>
<p><code>spectrapply</code> applies the provided function to each
<code>Spectrum</code> in the object and returns its
results. If no function is specified the function simply returns the
<code>list</code> of <code>Spectrum</code> objects.</p>
<p><code>XCMSnExp</code> objects can be combined with the <code>c</code> function. This
combines identified chromatographic peaks and the objects' pheno data but
discards alignment results or feature definitions.</p>
<p><code>plot</code> plots the spectrum data (see <code><a href='https://rdrr.io/r/base/plot.html'>plot</a></code> for
<code>MSnExp</code> objects in the <code>MSnbase</code> package for more details.
For <code>type = "XIC"</code>, identified chromatographic peaks will be indicated
as rectangles with border color <code>peakCol</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>processHistoryTypes</span>()

<span class='fu'>hasFilledChromPeaks</span>(<span class='no'>object</span>)

<span class='co'># S4 method for OnDiskMSnExp</span>
<span class='fu'><a href='profMat-xcmsSet.html'>profMat</a></span>(
  <span class='no'>object</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"bin"</span>,
  <span class='kw'>step</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>baselevel</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>basespace</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>mzrange.</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>fileIndex</span>,
  <span class='no'>...</span>
)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>show</span>(<span class='no'>object</span>)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>hasAdjustedRtime</span>(<span class='no'>object</span>)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>hasFeatures</span>(<span class='no'>object</span>, <span class='kw'>msLevel</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>20</span>)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>hasChromPeaks</span>(<span class='no'>object</span>, <span class='kw'>msLevel</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>20</span>)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>hasFilledChromPeaks</span>(<span class='no'>object</span>)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>adjustedRtime</span>(<span class='no'>object</span>, <span class='kw'>bySample</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>adjustedRtime</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>featureDefinitions</span>(
  <span class='no'>object</span>,
  <span class='kw'>mz</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  <span class='kw'>rt</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  <span class='kw'>ppm</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"any"</span>, <span class='st'>"within"</span>, <span class='st'>"apex_within"</span>),
  <span class='kw'>msLevel</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>20</span>
)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>featureDefinitions</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>chromPeaks</span>(
  <span class='no'>object</span>,
  <span class='kw'>bySample</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>rt</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  <span class='kw'>mz</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  <span class='kw'>ppm</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>msLevel</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>integer</a></span>(),
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"any"</span>, <span class='st'>"within"</span>, <span class='st'>"apex_within"</span>),
  <span class='kw'>isFilledColumn</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>chromPeaks</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>rtime</span>(<span class='no'>object</span>, <span class='kw'>bySample</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>adjusted</span> <span class='kw'>=</span> <span class='fu'>hasAdjustedRtime</span>(<span class='no'>object</span>))

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>mz</span>(<span class='no'>object</span>, <span class='kw'>bySample</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>BPPARAM</span> <span class='kw'>=</span> <span class='fu'>bpparam</span>())

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>intensity</span>(<span class='no'>object</span>, <span class='kw'>bySample</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>BPPARAM</span> <span class='kw'>=</span> <span class='fu'>bpparam</span>())

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>spectra</span>(
  <span class='no'>object</span>,
  <span class='kw'>bySample</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>adjusted</span> <span class='kw'>=</span> <span class='fu'>hasAdjustedRtime</span>(<span class='no'>object</span>),
  <span class='kw'>BPPARAM</span> <span class='kw'>=</span> <span class='fu'>bpparam</span>()
)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>processHistory</span>(<span class='no'>object</span>, <span class='no'>fileIndex</span>, <span class='no'>type</span>, <span class='no'>msLevel</span>)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>dropChromPeaks</span>(<span class='no'>object</span>, <span class='kw'>keepAdjustedRtime</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>dropFeatureDefinitions</span>(<span class='no'>object</span>, <span class='kw'>keepAdjustedRtime</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>dropLastN</span> <span class='kw'>=</span> -<span class='fl'>1</span>)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>dropAdjustedRtime</span>(<span class='no'>object</span>)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'><a href='profMat-xcmsSet.html'>profMat</a></span>(
  <span class='no'>object</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"bin"</span>,
  <span class='kw'>step</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>baselevel</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>basespace</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>mzrange.</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>fileIndex</span>,
  <span class='no'>...</span>
)

<span class='co'># S4 method for XCMSnExp,Param</span>
<span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span>(
  <span class='no'>object</span>,
  <span class='no'>param</span>,
  <span class='kw'>BPPARAM</span> <span class='kw'>=</span> <span class='fu'>bpparam</span>(),
  <span class='kw'>return.type</span> <span class='kw'>=</span> <span class='st'>"XCMSnExp"</span>,
  <span class='kw'>msLevel</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>dropFilledChromPeaks</span>(<span class='no'>object</span>)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>spectrapply</span>(<span class='no'>object</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>BPPARAM</span> <span class='kw'>=</span> <span class='fu'>bpparam</span>(), <span class='no'>...</span>)

<span class='co'># S3 method for XCMSnExp</span>
<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>...</span>)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>chromPeakData</span>(<span class='no'>object</span>)

<span class='co'># S4 method for XCMSnExp</span>
<span class='fu'>chromPeakData</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for XCMSnExp,missing</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"spectra"</span>, <span class='st'>"XIC"</span>), <span class='kw'>peakCol</span> <span class='kw'>=</span> <span class='st'>"#ff000060"</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>For <code>adjustedRtime</code>, <code>featureDefinitions</code>,
<code>chromPeaks</code>, <code>hasAdjustedRtime</code>, <code>hasFeatures</code> and
<code>hasChromPeaks</code> either a <code>MsFeatureData</code> or a <code>XCMSnExp</code>
object, for all other methods a <code>XCMSnExp</code> object.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>The profile matrix generation method. Allowed are <code>"bin"</code>,
<code>"binlin"</code>, <code>"binlinbase"</code> and <code>"intlin"</code>. See details
section for more information.</p></td>
    </tr>
    <tr>
      <th>step</th>
      <td><p>numeric(1) representing the m/z bin size.</p></td>
    </tr>
    <tr>
      <th>baselevel</th>
      <td><p>numeric(1) representing the base value to which
empty elements (i.e. m/z bins without a measured intensity) should be
set. Only considered if <code>method = "binlinbase"</code>. See
<code>baseValue</code> parameter of <code><a href='imputeLinInterpol.html'>imputeLinInterpol</a></code> for more
details.</p></td>
    </tr>
    <tr>
      <th>basespace</th>
      <td><p>numeric(1) representing the m/z length after
which the signal will drop to the base level. Linear interpolation will
be used between consecutive data points falling within
<code>2 * basespace</code> to each other. Only considered if
<code>method = "binlinbase"</code>. If not specified, it defaults to
<code>0.075</code>. Internally this parameter is translated into the
<code>distance</code> parameter of the <code><a href='imputeLinInterpol.html'>imputeLinInterpol</a></code>
function by <code>distance = floor(basespace / step)</code>. See
<code>distance</code> parameter of <code><a href='imputeLinInterpol.html'>imputeLinInterpol</a></code> for more
details.</p></td>
    </tr>
    <tr>
      <th>mzrange.</th>
      <td><p>Optional numeric(2) manually specifying the mz value range to
be used for binnind. If not provided, the whole mz value range is used.</p></td>
    </tr>
    <tr>
      <th>fileIndex</th>
      <td><p>For <code>processHistory</code>: optional <code>integer</code>
specifying the index of the files/samples for which the
<code><a href='ProcessHistory-class.html'>ProcessHistory</a></code> objects should be retrieved.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters.</p></td>
    </tr>
    <tr>
      <th>msLevel</th>
      <td><p><code>integer</code> specifying the MS level(s) for which identified
chromatographic peaks should be returned.</p></td>
    </tr>
    <tr>
      <th>bySample</th>
      <td><p>logical(1) specifying whether results should be grouped by
sample.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>For <code>adjustedRtime&lt;-</code>: a <code>list</code> (length equal to the
    number of samples) with numeric vectors representing the adjusted
    retention times per scan.</p>
<p>For <code>featureDefinitions&lt;-</code>: a <code>DataFrame</code> with peak
    grouping information. See return value for the <code>featureDefinitions</code>
    method for the expected format.</p>
<p>For <code>chromPeaks&lt;-</code>: a <code>matrix</code> with information on
    detected peaks. See return value for the <code>chromPeaks</code> method for the
    expected format.</p></td>
    </tr>
    <tr>
      <th>mz</th>
      <td><p>optional <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code> defining the mz range for which
chromatographic peaks should be returned.</p></td>
    </tr>
    <tr>
      <th>rt</th>
      <td><p>optional <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code> defining the retention time range for
which chromatographic peaks should be returned.</p></td>
    </tr>
    <tr>
      <th>ppm</th>
      <td><p>optional <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> specifying the ppm by which the
<code>mz</code> range should be extended. For a value of <code>ppm = 10</code>, all
peaks within <code>mz[1] - ppm / 1e6</code> and <code>mz[2] + ppm / 1e6</code> are
returned.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>For <code>processHistory</code>: restrict returned
<code><a href='ProcessHistory-class.html'>ProcessHistory</a></code> objects to analysis steps of a certain
type. Use the <code>processHistoryTypes</code> to list all supported values.
For <code>chromPeaks</code>: <code>character</code> specifying which peaks to return
if <code>rt</code> or <code>mz</code> are defined. For <code>type = "any"</code> all
chromatographic peaks partially overlapping the range defined by
<code>mz</code> and/or <code>rt</code> are returned, <code>type = "within"</code> returns
only peaks completely within the region and <code>type = "apex_within"</code>
peaks for which the peak's apex is within the region.</p></td>
    </tr>
    <tr>
      <th>isFilledColumn</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether a column <code>"is_filled"</code>
is included in the returned <code>"matrix"</code> providing the information
if a peak was filled in. Alternatively, this information would be
provided by the <code>chromPeakData</code> data frame.</p></td>
    </tr>
    <tr>
      <th>adjusted</th>
      <td><p>logical(1) whether adjusted or raw (i.e. the original
retention times reported in the files) should be returned.</p></td>
    </tr>
    <tr>
      <th>BPPARAM</th>
      <td><p>Parameter class for parallel processing. See
<code>bpparam</code>.</p></td>
    </tr>
    <tr>
      <th>keepAdjustedRtime</th>
      <td><p>For <code>dropFeatureDefinitions,XCMSnExp</code>:
<code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> defining whether eventually present retention time
adjustment should not be dropped. By default dropping feature definitions
drops retention time adjustment results too.</p></td>
    </tr>
    <tr>
      <th>dropLastN</th>
      <td><p>For <code>dropFeatureDefinitions,XCMSnExp</code>:
<code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the number of peak grouping related process
history steps to remove. By default <code>dropLastN = -1</code>, dropping the
chromatographic peaks removes all process history steps related to peak
grouping. Setting e.g. <code>dropLastN = 1</code> will only remove the most
recent peak grouping related process history step.</p></td>
    </tr>
    <tr>
      <th>param</th>
      <td><p>A <code><a href='findChromPeaks-centWave.html'>CentWaveParam</a></code>, <code><a href='findChromPeaks-matchedFilter.html'>MatchedFilterParam</a></code>,
<code><a href='findChromPeaks-massifquant.html'>MassifquantParam</a></code>, <code><a href='findPeaks-MSW.html'>MSWParam</a></code> or
<code><a href='findChromPeaks-centWaveWithPredIsoROIs.html'>CentWavePredIsoParam</a></code> object with the settings for the
chromatographic peak detection algorithm.</p></td>
    </tr>
    <tr>
      <th>return.type</th>
      <td><p>Character specifying what type of object the method should
return. Can be either <code>"XCMSnExp"</code> (default), <code>"list"</code> or
<code>"xcmsSet"</code>.</p></td>
    </tr>
    <tr>
      <th>add</th>
      <td><p>For <code>findChromPeaks</code>: if newly identified chromatographic
peaks should be added to the peak matrix with the already identified
chromatographic peaks. By default (<code>add = FALSE</code>) previous
peak detection results will be removed.</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>For <code>spectrapply</code>: a function that should be applied to each
spectrum in the object.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>For <code>plot</code>: <code>XCMSnExp</code> object.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>For <code>plot</code>: not used.</p></td>
    </tr>
    <tr>
      <th>peakCol</th>
      <td><p>For <code>plot</code>: the color that should be used to indicate
identified chromatographic peaks (only in combination with
<code>type = "XIC"</code> and if chromatographic peaks are present).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For <code>profMat</code>: a <code>list</code> with a the profile matrix
    <code>matrix</code> (or matrices if <code>fileIndex</code> was not specified or if
    <code>length(fileIndex) &gt; 1</code>). See <code><a href='profMat-xcmsSet.html'>profile-matrix</a></code> for
    general help and information about the profile matrix.</p>
<p>For <code>adjustedRtime</code>: if <code>bySample = FALSE</code> a <code>numeric</code>
vector with the adjusted retention for each spectrum of all files/samples
within the object. If <code>bySample = TRUE </code> a <code>list</code> (length equal
to the number of samples) with adjusted retention times grouped by
sample. Returns <code>NULL</code> if no adjusted retention times are present.</p>
<p>For <code>featureDefinitions</code>: a <code>DataFrame</code> with peak grouping
information, each row corresponding to one mz-rt feature (grouped peaks
within and across samples) and columns <code>"mzmed"</code> (median mz value),
<code>"mzmin"</code> (minimal mz value), <code>"mzmax"</code> (maximum mz value),
<code>"rtmed"</code> (median retention time), <code>"rtmin"</code> (minimal retention
time), <code>"rtmax"</code> (maximal retention time) and <code>"peakidx"</code>.
Column <code>"peakidx"</code> contains a <code>list</code> with indices of
chromatographic peaks (rows) in the matrix returned by the
<code>chromPeaks</code> method that belong to that feature group. The method
returns <code>NULL</code> if no feature definitions are present.</p>
<p>For <code>chromPeaks</code>: if <code>bySample = FALSE</code> a <code>matrix</code> (each row
being a chromatographic peak, rownames representing unique IDs of the peaks)
with at least the following columns:
<code>"mz"</code> (intensity-weighted mean of mz values of the peak across
scans/retention times),
<code>"mzmin"</code> (minimal mz value),
<code>"mzmax"</code> (maximal mz value),
<code>"rt"</code> (retention time of the peak apex),
<code>"rtmin"</code> (minimal retention time),
<code>"rtmax"</code> (maximal retention time),
<code>"into"</code> (integrated, original, intensity of the peak),
<code>"maxo"</code> (maximum intentity of the peak),
<code>"sample"</code> (sample index in which the peak was identified) and
Depending on the employed peak detection algorithm and the
<code>verboseColumns</code> parameter of it, additional columns might be
returned. If parameter <code>isFilledColumn</code> was set to <code>TRUE</code> a column
named <code>"is_filled"</code> is also returned.
For <code>bySample = TRUE</code> the chromatographic peaks are
returned as a <code>list</code> of matrices, each containing the
chromatographic peaks of a specific sample. For samples in which no
peaks were detected a matrix with 0 rows is returned.</p>
<p>For <code>rtime</code>: if <code>bySample = FALSE</code> a numeric vector with
the retention times of each scan, if <code>bySample = TRUE</code> a
<code>list</code> of numeric vectors with the retention times per sample.</p>
<p>For <code>mz</code>: if <code>bySample = FALSE</code> a <code>list</code> with the mz
values (numeric vectors) of each scan. If <code>bySample = TRUE</code> a
<code>list</code> with the mz values per sample.</p>
<p>For <code>intensity</code>: if <code>bySample = FALSE</code> a <code>list</code> with
the intensity values (numeric vectors) of each scan. If
<code>bySample = TRUE</code> a <code>list</code> with the intensity values per
sample.</p>
<p>For <code>spectra</code>: if <code>bySample = FALSE</code> a <code>list</code> with
<code>Spectrum</code> objects. If <code>bySample = TRUE</code> the
result is grouped by sample, i.e. as a <code>list</code> of <code>lists</code>, each
element in the <em>outer</em> <code>list</code> being the <code>list</code> of spectra
of the specific file.</p>
<p>For <code>processHistory</code>: a <code>list</code> of
<code><a href='ProcessHistory-class.html'>ProcessHistory</a></code> objects providing the details of the
individual data processing steps that have been performed.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl>
<dt><code>.processHistory</code></dt><dd><p><code>list</code> with <code>XProcessHistory</code> objects
tracking all individual analysis steps that have been performed.</p></dd>

<dt><code>msFeatureData</code></dt><dd><p><code>MsFeatureData</code> class extending <code>environment</code>
and containing the results from a chromatographic peak detection (element
<code>"chromPeaks"</code>), peak grouping (element <code>"featureDefinitions"</code>)
and retention time correction (element <code>"adjustedRtime"</code>) steps.
This object should not be manipulated directly.</p></dd>

</dl>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The <code>"chromPeaks"</code> element in the <code>msFeatureData</code> slot is
    equivalent to the <code>@peaks</code> slot of the <code>xcmsSet</code> object, the
    <code>"featureDefinitions"</code> contains information from the <code>@groups</code>
    and <code>@groupidx</code> slots from an <code>xcmsSet</code> object.</p>
    <h2 class="hasAnchor" id="chromatographic-peak-data"><a class="anchor" href="#chromatographic-peak-data"></a>Chromatographic peak data</h2>

    


<p>Chromatographic peak data is added to an <code>XCMSnExp</code> object by the
<code><a href='chromatographic-peak-detection.html'>findChromPeaks</a></code> function. Functions to access chromatographic
peak data are:</p>
<ul>
<li><p><code>hasChromPeaks</code> whether chromatographic peak data is available,
see below for help of the function.</p></li>
<li><p><code>chromPeaks</code> access chromatographic peaks (see below for help).</p></li>
<li><p><code>dropChromPeaks</code> remove chromatographic peaks (see below for
help).</p></li>
<li><p><code>dropFilledChromPeaks</code> remove filled-in peaks (see below for
help).</p></li>
<li><p><code><a href='fillChromPeaks.html'>fillChromPeaks</a></code> fill-in missing peaks (see respective
help page).</p></li>
<li><p><code><a href='plotChromPeaks.html'>plotChromPeaks</a></code> plot identified peaks for a file (see
respective help page).</p></li>
<li><p><code><a href='plotChromPeaks.html'>plotChromPeakImage</a></code> plot distribution of peaks along the
retention time axis (see respective help page).</p></li>
<li><p><code><a href='highlightChromPeaks.html'>highlightChromPeaks</a></code> add chromatographic peaks to an
existing plot of a <code>Chromatogram</code> (see respective help page).</p></li>
</ul>

    <h2 class="hasAnchor" id="adjusted-retention-times"><a class="anchor" href="#adjusted-retention-times"></a>Adjusted retention times</h2>

    


<p>Adjusted retention times are stored in an <code>XCMSnExp</code> object besides the
original, raw, retention times, allowing to switch between raw and adjusted
times. It is also possible to replace the raw retention times with the
adjusted ones with the <code><a href='applyAdjustedRtime.html'>applyAdjustedRtime</a></code>. The adjusted
retention times are added to an <code>XCMSnExp</code> by the
<code><a href='adjustRtime.html'>adjustRtime</a></code> function. All functions related to the access of
 adjusted retention times are:</p>
<ul>
<li><p><code>hasAdjustedRtime</code> whether adjusted retention times are available
(see below for help).</p></li>
<li><p><code>dropAdjustedRtime</code> remove adjusted retention times (see below
for help).</p></li>
<li><p><code><a href='applyAdjustedRtime.html'>applyAdjustedRtime</a></code> replace the raw retention times with
the adjusted ones (see respective help page).</p></li>
<li><p><code><a href='plotAdjustedRtime.html'>plotAdjustedRtime</a></code> plot differences between adjusted and
raw retention times (see respective help page).</p></li>
</ul>

    <h2 class="hasAnchor" id="correspondence-results-features"><a class="anchor" href="#correspondence-results-features"></a>Correspondence results, features</h2>

    


<p>The correspondence analysis (<code><a href='groupChromPeaks.html'>groupChromPeaks</a></code>) adds the feature
definitions to an <code>XCMSnExp</code> object. All functions related to these are
listed below:</p>
<ul>
<li><p><code>hasFeatures</code> whether correspondence results are available (see
below for help).</p></li>
<li><p><code>featureDefinitions</code> access the definitions of the features (see
below for help).</p></li>
<li><p><code>dropFeatureDefinitions</code> remove correspondence results (see below
for help).</p></li>
<li><p><code><a href='XCMSnExp-peak-grouping-results.html'>featureValues</a></code> access values for features (see respective
help page).</p></li>
<li><p><code><a href='featureSummary.html'>featureSummary</a></code> perform a simple summary of the defined
features (see respective help page).</p></li>
<li><p><code><a href='overlappingFeatures.html'>overlappingFeatures</a></code> identify features that are
overlapping or close in the m/z - rt space (see respective help page).</p></li>
<li><p><code>quantify</code> extract feature intensities and put them, along
with feature definitions and phenodata information, into a
<code>SummarizedExperiment</code>. See help page for details.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='xcmsSet-class.html'>xcmsSet</a></code> for the old implementation.
    <code>OnDiskMSnExp</code>, <code>MSnExp</code>
    and <code>pSet</code> for a complete list of inherited methods.</p>
<p><code><a href='chromatographic-peak-detection.html'>findChromPeaks</a></code> for available peak detection methods
    returning a <code>XCMSnExp</code> object as a result.</p>
<p><code><a href='groupChromPeaks.html'>groupChromPeaks</a></code> for available peak grouping
    methods and <code>featureDefinitions</code> for the method to extract
    the feature definitions representing the peak grouping results.
    <code><a href='adjustRtime.html'>adjustRtime</a></code> for retention time adjustment methods.</p>
<p><code><a href='chromatogram-method.html'>chromatogram</a></code> to extract MS data as
    <code>Chromatogram</code> objects.</p>
<p><code>as</code> (<code>as(x, "data.frame")</code>) in the <code>MSnbase</code>
    package for the method to extract MS data as <code>data.frame</code>s.</p>
<p><code><a href='featureSummary.html'>featureSummary</a></code> to calculate basic feature summaries.</p>
<p><code><a href='featureChromatograms.html'>featureChromatograms</a></code> to extract chromatograms for each
    feature.</p>
<p><code><a href='chromPeakSpectra.html'>chromPeakSpectra</a></code> to extract MS2 spectra with the m/z of
    the precursor ion within the m/z range of a peak and a retention time
    within its retention time range.</p>
<p><code><a href='featureSpectra.html'>featureSpectra</a></code> to extract MS2 spectra associated with
    identified features.</p>
<p><code><a href='fillChromPeaks.html'>fillChromPeaks</a></code> for the method to fill-in eventually
    missing chromatographic peaks for a feature in some samples.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Loading the data from 2 files of the faahKO package.</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>faahKO</span>)
<span class='no'>od</span> <span class='kw'>&lt;-</span> <span class='fu'>readMSData</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"cdf/KO/ko15.CDF"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"faahKO"</span>),
                   <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"cdf/KO/ko16.CDF"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"faahKO"</span>)),
                 <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"onDisk"</span>)</div><div class='output co'>#&gt; <span class='message'>Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span></div><div class='input'><span class='co'>## Now we perform a chromatographic peak detection on this data set using the</span>
<span class='co'>## matched filter method. We are tuning the settings such that it performs</span>
<span class='co'>## faster.</span>
<span class='no'>mfp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='findChromPeaks-matchedFilter.html'>MatchedFilterParam</a></span>(<span class='kw'>binSize</span> <span class='kw'>=</span> <span class='fl'>6</span>)
<span class='no'>xod</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span>(<span class='no'>od</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='no'>mfp</span>)

<span class='co'>## The results from the peak detection are now stored in the XCMSnExp</span>
<span class='co'>## object</span>
<span class='no'>xod</span></div><div class='output co'>#&gt; MSn experiment data ("XCMSnExp")
#&gt; Object size in memory: 0.86 Mb
#&gt; - - - Spectra data - - -
#&gt;  MS level(s): 1 
#&gt;  Number of spectra: 2556 
#&gt;  MSn retention times: 41:41 - 74:60 minutes
#&gt; - - - Processing information - - -
#&gt; Data loaded [Tue May 12 19:47:01 2020] 
#&gt;  MSnbase version: 2.14.1 
#&gt; - - - Meta data  - - -
#&gt; phenoData
#&gt;   rowNames: ko15.CDF ko16.CDF
#&gt;   varLabels: sampleNames
#&gt;   varMetadata: labelDescription
#&gt; Loaded from:
#&gt;   ko15.CDF,   ko16.CDF 
#&gt; protocolData: none
#&gt; featureData
#&gt;   featureNames: F1.S0001 F1.S0002 ... F2.S1278 (2556 total)
#&gt;   fvarLabels: fileIdx spIdx ... spectrum (33 total)
#&gt;   fvarMetadata: labelDescription
#&gt; experimentData: use 'experimentData(object)'
#&gt; - - - xcms preprocessing - - -
#&gt; Chromatographic peak detection:
#&gt;  method: matchedFilter 
#&gt;  287 peaks identified in 2 samples.
#&gt;  On average 144 chromatographic peaks per sample.</div><div class='input'>
<span class='co'>## The detected peaks can be accessed with the chromPeaks method.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'>chromPeaks</span>(<span class='no'>xod</span>))</div><div class='output co'>#&gt;             mz mzmin mzmax       rt    rtmin    rtmax      into      intf  maxo
#&gt; CP001 205.0000 205.0 205.0 2784.635 2770.550 2800.284 1778568.9 3587224.8 84280
#&gt; CP002 205.0000 205.0 205.0 2784.635 2770.550 2800.284 1778568.9 3577971.3 84280
#&gt; CP003 207.0839 207.0 207.1 2711.082 2698.562 2723.601  358347.2  614916.6 18800
#&gt; CP004 207.0821 207.0 207.1 2712.647 2698.562 2726.731  380873.0  700427.6 18800
#&gt; CP005 241.1460 241.1 241.2 3664.138 3646.924 3682.918 1465988.7 2129287.6 49728
#&gt; CP006 241.1460 241.1 241.2 3662.574 3646.924 3682.918 1465988.7 2234510.3 49728
#&gt;            maxf i       sn sample
#&gt; CP001 194307.73 1 68.23222      1
#&gt; CP002 194213.46 1 61.65173      1
#&gt; CP003  36745.31 2 11.66454      1
#&gt; CP004  38897.65 1 20.03490      1
#&gt; CP005  93657.70 1 15.26057      1
#&gt; CP006  96022.23 1 25.51268      1</div><div class='input'>
<span class='co'>## The settings of the chromatographic peak detection can be accessed with</span>
<span class='co'>## the processHistory method</span>
<span class='fu'>processHistory</span>(<span class='no'>xod</span>)</div><div class='output co'>#&gt; [[1]]
#&gt; Object of class "XProcessHistory"
#&gt;  type: Peak detection 
#&gt;  date: Tue May 12 19:47:01 2020 
#&gt;  info:  
#&gt;  fileIndex: 1,2 
#&gt;  Parameter class: MatchedFilterParam 
#&gt;  MS level(s) 1 
#&gt; </div><div class='input'>
<span class='co'>## Also the parameter class for the peak detection can be accessed</span>
<span class='fu'><a href='ProcessHistory-class.html'>processParam</a></span>(<span class='fu'>processHistory</span>(<span class='no'>xod</span>)<span class='kw'>[[</span><span class='fl'>1</span>]])</div><div class='output co'>#&gt; Object of class:  MatchedFilterParam 
#&gt; Parameters:
#&gt;  binSize: 6 
#&gt;  impute: none 
#&gt;  baseValue:  
#&gt;  distance:  
#&gt;  fwhm: 30 
#&gt;  sigma: 12.73994 
#&gt;  max: 5 
#&gt;  snthresh: 10 
#&gt;  steps: 2 
#&gt;  mzdiff: -11.2 
#&gt;  index: FALSE </div><div class='input'>
<span class='co'>## The XCMSnExp inherits all methods from the pSet and OnDiskMSnExp classes</span>
<span class='co'>## defined in Bioconductor's MSnbase package. To access the (raw) retention</span>
<span class='co'>## time for each spectrum we can use the rtime method. Setting bySample = TRUE</span>
<span class='co'>## would cause the retention times to be grouped by sample</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'>rtime</span>(<span class='no'>xod</span>))</div><div class='output co'>#&gt; F1.S0001 F1.S0002 F1.S0003 F1.S0004 F1.S0005 F1.S0006 
#&gt; 2501.378 2502.943 2504.508 2506.073 2507.638 2509.203 </div><div class='input'>
<span class='co'>## Similarly it is possible to extract the mz values or the intensity values</span>
<span class='co'>## using the mz and intensity method, respectively, also with the option to</span>
<span class='co'>## return the results grouped by sample instead of the default, which is</span>
<span class='co'>## grouped by spectrum. Finally, to extract all of the data we can use the</span>
<span class='co'>## spectra method which returns Spectrum objects containing all raw data.</span>
<span class='co'>## Note that all these methods read the information from the original input</span>
<span class='co'>## files and subsequently apply eventual data processing steps to them.</span>
<span class='no'>mzs</span> <span class='kw'>&lt;-</span> <span class='fu'>mz</span>(<span class='no'>xod</span>, <span class='kw'>bySample</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>mzs</span>)</div><div class='output co'>#&gt; [1] 2</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/lengths.html'>lengths</a></span>(<span class='no'>mzs</span>)</div><div class='output co'>#&gt;      1      2 
#&gt; 445769 440794 </div><div class='input'>
<span class='co'>## The full data could also be read using the spectra data, which returns</span>
<span class='co'>## a list of Spectrum object containing the mz, intensity and rt values.</span>
<span class='co'>## spctr &lt;- spectra(xod)</span>
<span class='co'>## To get all spectra of the first file we can split them by file</span>
<span class='co'>## head(split(spctr, fromFile(xod))[[1]])</span>

<span class='co'>############</span>
<span class='co'>## Filtering</span>
<span class='co'>##</span>
<span class='co'>## XCMSnExp objects can be filtered by file, retention time, mz values or</span>
<span class='co'>## MS level. For some of these filter preprocessing results (mostly</span>
<span class='co'>## retention time correction and peak grouping results) will be dropped.</span>
<span class='co'>## Below we filter the XCMSnExp object by file to extract the results for</span>
<span class='co'>## only the second file.</span>
<span class='no'>xod_2</span> <span class='kw'>&lt;-</span> <span class='fu'>filterFile</span>(<span class='no'>xod</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='no'>xod_2</span></div><div class='output co'>#&gt; MSn experiment data ("XCMSnExp")
#&gt; Object size in memory: 0.49 Mb
#&gt; - - - Spectra data - - -
#&gt;  MS level(s): 1 
#&gt;  Number of spectra: 1278 
#&gt;  MSn retention times: 41:41 - 74:60 minutes
#&gt; - - - Processing information - - -
#&gt; Data loaded [Tue May 12 19:47:01 2020] 
#&gt; Filter: select file(s) 2. [Tue May 12 19:47:06 2020] 
#&gt;  MSnbase version: 2.14.1 
#&gt; - - - Meta data  - - -
#&gt; phenoData
#&gt;   rowNames: ko16.CDF
#&gt;   varLabels: sampleNames
#&gt;   varMetadata: labelDescription
#&gt; Loaded from:
#&gt;   ko16.CDF 
#&gt; protocolData: none
#&gt; featureData
#&gt;   featureNames: F2.S0001 F2.S0002 ... F2.S1278 (1278 total)
#&gt;   fvarLabels: fileIdx spIdx ... spectrum (33 total)
#&gt;   fvarMetadata: labelDescription
#&gt; experimentData: use 'experimentData(object)'
#&gt; - - - xcms preprocessing - - -
#&gt; Chromatographic peak detection:
#&gt;  method: matchedFilter 
#&gt;  154 peaks identified in 1 samples.
#&gt;  On average 154 chromatographic peaks per sample.</div><div class='input'>
<span class='co'>## Now the objects contains only the idenfified peaks for the second file</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'>chromPeaks</span>(<span class='no'>xod_2</span>))</div><div class='output co'>#&gt;             mz mzmin mzmax       rt    rtmin    rtmax      into      intf  maxo
#&gt; CP134 205.0000 205.0 205.0 2790.894 2776.810 2806.544 1567038.1 3046964.5 68384
#&gt; CP135 200.1000 200.1 200.1 2876.967 2862.882 2891.051  451600.7  864843.3 24192
#&gt; CP136 201.0914 201.0 201.1 3143.009 3127.359 3157.093  272872.0  535062.8 13156
#&gt; CP137 205.0000 205.0 205.0 2790.894 2776.810 2806.544 1567038.1 3044611.7 68384
#&gt; CP138 207.0980 207.0 207.1 2717.341 2704.822 2731.426  436446.4  796731.1 22024
#&gt; CP139 201.0914 201.0 201.1 3143.009 3127.359 3157.093  272872.0  532914.1 13156
#&gt;            maxf i       sn sample
#&gt; CP134 158431.02 1 59.87213      1
#&gt; CP135  48407.04 2 18.29334      1
#&gt; CP136  29191.65 3 11.03172      1
#&gt; CP137 158418.27 1 56.79138      1
#&gt; CP138  45301.11 2 16.24000      1
#&gt; CP139  29123.90 3 10.44063      1</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'>chromPeaks</span>(<span class='no'>xod</span>)[<span class='fu'>chromPeaks</span>(<span class='no'>xod</span>)[, <span class='st'>"sample"</span>] <span class='kw'>==</span> <span class='fl'>2</span>, ])</div><div class='output co'>#&gt;             mz mzmin mzmax       rt    rtmin    rtmax      into      intf  maxo
#&gt; CP134 205.0000 205.0 205.0 2790.894 2776.810 2806.544 1567038.1 3046964.5 68384
#&gt; CP135 200.1000 200.1 200.1 2876.967 2862.882 2891.051  451600.7  864843.3 24192
#&gt; CP136 201.0914 201.0 201.1 3143.009 3127.359 3157.093  272872.0  535062.8 13156
#&gt; CP137 205.0000 205.0 205.0 2790.894 2776.810 2806.544 1567038.1 3044611.7 68384
#&gt; CP138 207.0980 207.0 207.1 2717.341 2704.822 2731.426  436446.4  796731.1 22024
#&gt; CP139 201.0914 201.0 201.1 3143.009 3127.359 3157.093  272872.0  532914.1 13156
#&gt;            maxf i       sn sample
#&gt; CP134 158431.02 1 59.87213      2
#&gt; CP135  48407.04 2 18.29334      2
#&gt; CP136  29191.65 3 11.03172      2
#&gt; CP137 158418.27 1 56.79138      2
#&gt; CP138  45301.11 2 16.24000      2
#&gt; CP139  29123.90 3 10.44063      2</div><div class='input'>
<span class='co'>##########</span>
<span class='co'>## Coercing to an xcmsSet object</span>
<span class='co'>##</span>
<span class='co'>## We can also coerce the XCMSnExp object into an xcmsSet object:</span>
<span class='no'>xs</span> <span class='kw'>&lt;-</span> <span class='fu'>as</span>(<span class='no'>xod</span>, <span class='st'>"xcmsSet"</span>)</div><div class='output co'>#&gt; <span class='message'>Note: you might want to set/adjust the 'sampclass' of the returned xcmSet object before proceeding with the analysis.</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='xcmsSet-class.html'>peaks</a></span>(<span class='no'>xs</span>))</div><div class='output co'>#&gt;             mz mzmin mzmax       rt    rtmin    rtmax      into      intf  maxo
#&gt; CP001 205.0000 205.0 205.0 2784.635 2770.550 2800.284 1778568.9 3587224.8 84280
#&gt; CP002 205.0000 205.0 205.0 2784.635 2770.550 2800.284 1778568.9 3577971.3 84280
#&gt; CP003 207.0839 207.0 207.1 2711.082 2698.562 2723.601  358347.2  614916.6 18800
#&gt; CP004 207.0821 207.0 207.1 2712.647 2698.562 2726.731  380873.0  700427.6 18800
#&gt; CP005 241.1460 241.1 241.2 3664.138 3646.924 3682.918 1465988.7 2129287.6 49728
#&gt; CP006 241.1460 241.1 241.2 3662.574 3646.924 3682.918 1465988.7 2234510.3 49728
#&gt;            maxf i       sn sample
#&gt; CP001 194307.73 1 68.23222      1
#&gt; CP002 194213.46 1 61.65173      1
#&gt; CP003  36745.31 2 11.66454      1
#&gt; CP004  38897.65 1 20.03490      1
#&gt; CP005  93657.70 1 15.26057      1
#&gt; CP006  96022.23 1 25.51268      1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


