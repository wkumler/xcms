<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>General visualizations of peak detection results — plotChromPeaks • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="General visualizations of peak detection results — plotChromPeaks" />
<meta property="og:description" content="plotChromPeaks plots the identified chromatographic
peaks from one file into the plane spanned by the retention time and mz
dimension (x-axis representing the retention time and y-axis mz).
Each chromatographic peak is plotted as a rectangle representing its
width in rt and mz dimension.
This plot is supposed to provide some initial overview of the
chromatographic peak detection results.
plotChromPeakImage plots the number of detected peaks for
each sample along the retention time axis as an image plot, i.e.
with the number of peaks detected in each bin along the retention time
represented with the color of the respective cell." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/new_functionality.html">New and modified functionality in xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>General visualizations of peak detection results</h1>
    <small class="dont-index">Source: <a href='https://github.com/sneumann/xcms/blob/master/R/functions-XCMSnExp.R'><code>R/functions-XCMSnExp.R</code></a></small>
    <div class="hidden name"><code>plotChromPeaks.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>plotChromPeaks</code> plots the identified chromatographic
peaks from one file into the plane spanned by the retention time and mz
dimension (x-axis representing the retention time and y-axis mz).
Each chromatographic peak is plotted as a rectangle representing its
width in rt and mz dimension.</p>
<p>This plot is supposed to provide some initial overview of the
chromatographic peak detection results.</p>
<p><code>plotChromPeakImage</code> plots the number of detected peaks for
each sample along the retention time axis as an <em>image</em> plot, i.e.
with the number of peaks detected in each bin along the retention time
represented with the color of the respective cell.</p>
    </div>

    <pre class="usage"><span class='fu'>plotChromPeaks</span>(
  <span class='no'>x</span>,
  <span class='kw'>file</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>border</span> <span class='kw'>=</span> <span class='st'>"#00000060"</span>,
  <span class='kw'>col</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"retention time"</span>,
  <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"mz"</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>...</span>
)

<span class='fu'>plotChromPeakImage</span>(
  <span class='no'>x</span>,
  <span class='kw'>binSize</span> <span class='kw'>=</span> <span class='fl'>30</span>,
  <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>log</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"retention time"</span>,
  <span class='kw'>yaxt</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='st'>"yaxt"</span>),
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Chromatographic peak counts"</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code><a href='XCMSnExp-class.html'>XCMSnExp</a></code> object.</p></td>
    </tr>
    <tr>
      <th>file</th>
      <td><p>For <code>plotChromPeaks</code>: <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> specifying the
index of the file within <code>x</code> for which the plot should be created.
Defaults to <code>1</code>.</p></td>
    </tr>
    <tr>
      <th>xlim</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code> specifying the x-axis limits (retention time
dimension). Defaults to <code>NULL</code> in which case the full retention
time range of the file is used.</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>For <code>plotChromPeaks</code>: <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code> specifying the
y-axis limits (mz dimension). Defaults to <code>NULL</code> in which case the
full mz range of the file is used.</p></td>
    </tr>
    <tr>
      <th>add</th>
      <td><p>For <code>plotChromPeaks</code>: <code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether the plot
should be added or created as a new plot.</p></td>
    </tr>
    <tr>
      <th>border</th>
      <td><p>For <code>plotChromPeaks</code>: the color for the rectangles'
border.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>For <code>plotChromPeaks</code>: the color to be used to fill the
rectangles.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> defining the x-axis label.</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>For <code>plotChromPeaks</code>: <code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> defining the
y-axis label.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> defining the plot title. By default (i.e.
<code>main = NULL</code> the name of the file will be used as title.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to the <code>plot</code> (for
<code>plotChromPeaks</code>) and <code>image</code> (for
<code>plotChromPeakImage</code>) functions. Ignored if <code>add = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>binSize</th>
      <td><p>For <code>plotChromPeakImage</code>: <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the
size of the bins along the x-axis (retention time). Defaults to
<code>binSize = 30</code>, peaks within each 30 seconds will thus counted and
plotted.</p></td>
    </tr>
    <tr>
      <th>log</th>
      <td><p>For <code>plotChromPeakImage</code>: <code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether the peak
counts should be log2 transformed before plotting.</p></td>
    </tr>
    <tr>
      <th>yaxt</th>
      <td><p>For <code>plotChromPeakImage</code>: <code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> defining
whether y-axis labels should be added. To disable the y-axis use
<code>yaxt = "n"</code>. For any other value of <code>yaxt</code> the axis will be
drawn. See <code>par</code> help page for more details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The width and line type of the rectangles indicating the detected
chromatographic peaks for the <code>plotChromPeaks</code> function can be
specified using the <code>par</code> function, i.e. with <code><a href='https://rdrr.io/r/graphics/par.html'>par(lwd = 3)</a></code>
and <code><a href='https://rdrr.io/r/graphics/par.html'>par(lty = 2)</a></code>, respectively.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='highlightChromPeaks.html'>highlightChromPeaks</a></code> for the function to highlight
    detected chromatographic peaks in extracted ion chromatogram plots.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Perform peak detection on two files from the faahKO package.</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>xcms</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>faahKO</span>)
<span class='no'>faahko_file</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>'cdf/KO/ko16.CDF'</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"faahKO"</span>),
                 <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>'cdf/KO/ko18.CDF'</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"faahKO"</span>))

<span class='no'>od</span> <span class='kw'>&lt;-</span> <span class='fu'>readMSData</span>(<span class='no'>faahko_file</span>, <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"onDisk"</span>)</div><div class='output co'>#&gt; <span class='message'>Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span></div><div class='input'>
<span class='co'>## Peak detection using the 'matchedFilter' method. Note that we are using a</span>
<span class='co'>## larger binSize to reduce the runtime of the example.</span>
<span class='no'>xod</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span>(<span class='no'>od</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'><a href='findChromPeaks-matchedFilter.html'>MatchedFilterParam</a></span>(<span class='kw'>binSize</span> <span class='kw'>=</span> <span class='fl'>0.3</span>, <span class='kw'>snthresh</span> <span class='kw'>=</span> <span class='fl'>20</span>))

<span class='co'>## plotChromPeakImage: plot an image for the identified peaks per file</span>
<span class='fu'>plotChromPeakImage</span>(<span class='no'>xod</span>)</div><div class='img'><img src='plotChromPeaks-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Show all detected chromatographic peaks from the first file</span>
<span class='fu'>plotChromPeaks</span>(<span class='no'>xod</span>)</div><div class='img'><img src='plotChromPeaks-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Plot all detected peaks from the second file and restrict the plot to a</span>
<span class='co'>## mz-rt slice</span>
<span class='fu'>plotChromPeaks</span>(<span class='no'>xod</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3500</span>, <span class='fl'>3600</span>), <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>400</span>, <span class='fl'>600</span>))</div><div class='img'><img src='plotChromPeaks-3.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


