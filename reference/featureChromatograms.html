<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extract ion chromatograms for each feature — featureChromatograms • xcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Extract ion chromatograms for each feature — featureChromatograms" />
<meta property="og:description" content="Extract ion chromatograms for features in an XCMSnExp object. The
function returns for each feature its extracted ion chromatogram and all
associated peaks with it. The chromatogram is extracted from the m/z - rt
region including all chromatographic peaks of that features (i.e. based on
the ranges of &quot;mzmin&quot;, &quot;mzmax&quot;, &quot;rtmin&quot;, &quot;rtmax&quot; of all
chromatographic peaks of the feature).
By default only chromatographic peaks associated with a feature are included
for an extracted ion chromatogram (parameter include = &quot;feature_only&quot;). By
setting include = &quot;apex_within&quot; all chromatographic peaks (and eventually
the feature which they are part of - if feature definitions are present)
that have their apex position within the m/z - rt range from which the
chromatogram is extracted are returned too.
With include = &quot;any&quot; or include = &quot;all&quot; all chromatographic peaks (and
eventually the feature in which they are present) overlapping the m/z and rt
range will be returned." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/new_functionality.html">New and modified functionality in xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sneumann/xcms/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract ion chromatograms for each feature</h1>
    <small class="dont-index">Source: <a href='https://github.com/sneumann/xcms/blob/master/R/functions-XCMSnExp.R'><code>R/functions-XCMSnExp.R</code></a></small>
    <div class="hidden name"><code>featureChromatograms.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extract ion chromatograms for features in an <a href='XCMSnExp-class.html'>XCMSnExp</a> object. The
function returns for each feature its extracted ion chromatogram and all
associated peaks with it. The chromatogram is extracted from the m/z - rt
region including all chromatographic peaks of that features (i.e. based on
the ranges of <code>"mzmin"</code>, <code>"mzmax"</code>, <code>"rtmin"</code>, <code>"rtmax"</code> of all
chromatographic peaks of the feature).</p>
<p>By default only chromatographic peaks associated with a feature are included
for an extracted ion chromatogram (parameter <code>include = "feature_only"</code>). By
setting <code>include = "apex_within"</code> all chromatographic peaks (and eventually
the feature which they are part of - if feature definitions are present)
that have their apex position within the m/z - rt range from which the
chromatogram is extracted are returned too.
With <code>include = "any"</code> or <code>include = "all"</code> all chromatographic peaks (and
eventually the feature in which they are present) overlapping the m/z and rt
range will be returned.</p>
    </div>

    <pre class="usage"><span class='fu'>featureChromatograms</span>(
  <span class='no'>x</span>,
  <span class='kw'>expandRt</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>aggregationFun</span> <span class='kw'>=</span> <span class='st'>"max"</span>,
  <span class='no'>features</span>,
  <span class='kw'>include</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"feature_only"</span>, <span class='st'>"apex_within"</span>, <span class='st'>"any"</span>, <span class='st'>"all"</span>),
  <span class='kw'>filled</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code>XCMSnExp</code> object with grouped chromatographic peaks.</p></td>
    </tr>
    <tr>
      <th>expandRt</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> to expand the retention time range for each
chromatographic peak by a constant value on each side.</p></td>
    </tr>
    <tr>
      <th>aggregationFun</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> specifying the name that should be
used to aggregate intensity values across the m/z value range for
the same retention time. The default <code>"sum"</code> returns a base peak
chromatogram.</p></td>
    </tr>
    <tr>
      <th>features</th>
      <td><p><code>integer</code>, <code>character</code> or <code>logical</code> defining a subset of
features for which chromatograms should be returned. Can be the index
of the features in <code>featureDefinitions</code>, feature IDs (row names of
<code>featureDefinitions</code>) or a logical vector.</p></td>
    </tr>
    <tr>
      <th>include</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> defining which chromatographic peaks (and
related feature definitions) should be included in the returned
<code><a href='XChromatogram.html'>XChromatograms()</a></code>. Defaults to <code>"feature_only"</code>; See description above
for options and details.</p></td>
    </tr>
    <tr>
      <th>filled</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether filled-in peaks should be included in
the result object. The default is <code>filled = FALSE</code>, i.e. only detected
peaks are reported.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>optional arguments to be passed along to the <code><a href='chromatogram-method.html'>chromatogram()</a></code>
function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code><a href='XChromatogram.html'>XChromatograms()</a></code> object.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>xcms</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>faahKO</span>)
<span class='no'>faahko_3_files</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>'cdf/KO/ko15.CDF'</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"faahKO"</span>),
                    <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>'cdf/KO/ko18.CDF'</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"faahKO"</span>))

<span class='co'>## Do a simple and fast preprocessing on a subset of the test data</span>
<span class='no'>od</span> <span class='kw'>&lt;-</span> <span class='fu'>filterRt</span>(<span class='fu'>readMSData</span>(<span class='no'>faahko_3_files</span>, <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"onDisk"</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>250</span>, <span class='fl'>3000</span>))</div><div class='output co'>#&gt; <span class='message'>Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span></div><div class='input'><span class='no'>od</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='chromatographic-peak-detection.html'>findChromPeaks</a></span>(<span class='no'>od</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'><a href='findChromPeaks-centWave.html'>CentWaveParam</a></span>(<span class='kw'>peakwidth</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>30</span>, <span class='fl'>80</span>),
    <span class='kw'>noise</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>prefilter</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>, <span class='fl'>10000</span>)))
<span class='no'>od</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='adjustRtime.html'>adjustRtime</a></span>(<span class='no'>od</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'><a href='adjustRtime-obiwarp.html'>ObiwarpParam</a></span>(<span class='kw'>binSize</span> <span class='kw'>=</span> <span class='fl'>0.6</span>))</div><div class='output co'>#&gt; <span class='message'>Sample number 1 used as center sample.</span></div><div class='output co'>#&gt; <span class='message'>Aligning ko18.CDF against ko15.CDF ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Applying retention time adjustment to the identified chromatographic peaks ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'><span class='no'>od</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='groupChromPeaks.html'>groupChromPeaks</a></span>(<span class='no'>od</span>,
    <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'><a href='groupChromPeaks-density.html'>PeakDensityParam</a></span>(<span class='kw'>minFraction</span> <span class='kw'>=</span> <span class='fl'>0.8</span>, <span class='kw'>sampleGroups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>)))</div><div class='output co'>#&gt; <span class='message'>Processing 3084 mz slices ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='co'>## Get the feature definitions</span>
<span class='fu'><a href='XCMSnExp-class.html'>featureDefinitions</a></span>(<span class='no'>od</span>)</div><div class='output co'>#&gt; DataFrame with 27 rows and 10 columns
#&gt;          mzmed     mzmin     mzmax     rtmed     rtmin     rtmax    npeaks
#&gt;      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
#&gt; FT01     205.0     205.0     205.0   2785.25   2784.29   2786.20         2
#&gt; FT02     279.0     279.0     279.0   2784.64   2784.29   2784.64         3
#&gt; FT03     280.0     280.0     280.0   2784.46   2784.29   2784.64         2
#&gt; FT04     284.1     284.1     284.1   2714.89   2714.21   2715.56         2
#&gt; FT05     301.0     301.0     301.0   2784.46   2784.29   2784.64         2
#&gt; ...        ...       ...       ...       ...       ...       ...       ...
#&gt; FT23     430.1     430.1     430.1   2682.13   2681.35   2682.91         2
#&gt; FT24     431.1     431.1     431.1   2680.56   2678.22   2682.91         2
#&gt; FT25     486.2     486.2     486.2   2795.29   2793.42   2797.15         2
#&gt; FT26     579.1     579.1     579.1   2785.25   2784.29   2786.20         2
#&gt; FT27     580.1     580.1     580.1   2784.46   2784.29   2784.64         2
#&gt;             X1  peakidx  ms_level
#&gt;      &lt;numeric&gt;   &lt;list&gt; &lt;integer&gt;
#&gt; FT01         2    35,82         1
#&gt; FT02         2 19,33,85         1
#&gt; FT03         2    23,74         1
#&gt; FT04         2    17,68         1
#&gt; FT05         2    36,84         1
#&gt; ...        ...      ...       ...
#&gt; FT23         2    16,64         1
#&gt; FT24         2     7,67         1
#&gt; FT25         2    25,80         1
#&gt; FT26         2    26,78         1
#&gt; FT27         2    22,72         1</div><div class='input'>
<span class='co'>## Extract ion chromatograms for the first 3 features. Parameter</span>
<span class='co'>## `features` can be either the feature IDs or feature indices.</span>
<span class='no'>chrs</span> <span class='kw'>&lt;-</span> <span class='fu'>featureChromatograms</span>(<span class='no'>od</span>, <span class='kw'>features</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>3</span>)

<span class='co'>## Plot the XIC for the first feature using different colors for each file</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>chrs</span>[<span class='fl'>1</span>, ], <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"red"</span>, <span class='st'>"green"</span>))</div><div class='img'><img src='featureChromatograms-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


